{"version":3,"file":"js/931.cdf1c623.js","mappings":"6gCAYA,MAAMA,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,MAETC,GAAYC,EAAAA,EAAAA,KAAI,GAKtB,IAAIC,GAAYC,EAAAA,EAAAA,IAAS,CACrBC,IAAKA,IAAKR,EAAMS,MAAMC,QAAQJ,UAC9BK,IAAMC,GAASZ,EAAMa,OAAO,yCAA0CD,KAM1E,SAASE,IAEFR,EAAUS,MAAMC,SAGnBZ,EAAUW,OAAQ,EAGlBE,EAAAA,EAAIT,IAAIU,EAAAA,EAAUC,8BACTC,MAAKC,IACFf,EAAUS,MAAQM,EAAST,KAAKA,KAGhCR,EAAUW,OAAQ,CAAK,IAE1BO,OAAMC,GAASnB,EAAUW,OAAQ,IAC9C,CACA,SAASS,EAAYC,GAKjB,OAHAzB,EAAMa,OAAO,6BAA8Ba,KAAKC,MAAMD,KAAKE,UAAUH,KAG9DvB,EAAO2B,KAAK,CACfC,KAAM,yBACNC,OAAQ,CACJC,UAAWP,EAAQK,KAAKG,WAAWC,QAAQ,IAAK,OAG5D,CAEA,SAASC,EAAcV,GACnBW,EAAAA,EAAaC,OAAO,qFAAsF,iBAAkB,CACxHC,kBAAmB,SACnBC,iBAAkB,SAClBC,iBAAkB,mCAClBC,eAAiB1B,MACTA,IAAUA,EAAMC,SACT,yBAKVI,MAAK,EAAGL,YAEL,IAAI2B,EAAU,CACVC,GAAIlB,EAAQkB,GACZC,OAAQ7B,GAIZ8B,EAAcH,EAAQ,IAEzBpB,OAAM,QACnB,CACA,SAASuB,EAAcH,GAEnBtC,EAAUW,OAAQ,EAGlBE,EAAAA,EAAI6B,KAAK5B,EAAAA,EAAU6B,8BAA+BL,GACzCtB,MAAKC,IAGF,IAAI2B,EAAgBtB,KAAKC,MAAMD,KAAKE,UAAUtB,EAAUS,QAEpDkC,EAAeD,EAAcE,WAAUC,GAASA,EAAMR,IAAMD,EAAQC,KAErEM,GAAgB,IACfD,EAAcI,OAAOH,EAAc,GAEnC3C,EAAUS,MAAQiC,GAItBK,EAAEC,MAAMC,OAAO,CAACC,QAASnC,EAAST,KAAK4C,UAGvCpD,EAAUW,OAAQ,CAAK,IAE1BO,OAAMC,GAASnB,EAAUW,OAAQ,GAC9C,C,OAGA0C,EAAAA,EAAAA,KAAU,KAEN3C,GAAgB,I,4lCC9GpB,MAAM4C,EAAc,EAEpB,O","sources":["webpack://myzola-admin/./src/views/explore/companies/List.vue","webpack://myzola-admin/./src/views/explore/companies/List.vue?669b"],"sourcesContent":["<script setup>\r\n\r\nimport {ref, computed, onMounted} from \"vue\";\r\nimport api from \"@/services/api\";\r\nimport {apiRoutes} from \"@/services/apiRoutes\";\r\nimport {useStore} from \"vuex\";\r\nimport {useRouter} from \"vue-router\";\r\nimport {ElMessageBox} from \"element-plus\";\r\n\r\n/**\r\n * Variables\r\n * */\r\nconst store = useStore();\r\nconst router = useRouter();\r\n\r\nconst isLoading = ref(false);\r\n\r\n/**\r\n * Computed Properties\r\n * */\r\nlet companies = computed({\r\n    get: ()=> store.state.explore.companies,\r\n    set: (data) => store.commit('explore/STORE_EXPLORE_LISTED_COMPANIES', data)\r\n});\r\n\r\n/**\r\n * Methods\r\n * */\r\nfunction fetchCompanies(){\r\n    //don't run if companies are already fetched\r\n    if(companies.value.length) return;\r\n\r\n    //show loader\r\n    isLoading.value = true;\r\n\r\n    //make api call\r\n    api.get(apiRoutes.GET_EXPLORE_LISTED_COMPANIES)\r\n            .then(response => {\r\n                companies.value = response.data.data;\r\n\r\n                //dismiss loader\r\n                isLoading.value = false;\r\n            })\r\n            .catch(error => isLoading.value = false);\r\n}\r\nfunction viewCompany(company){\r\n    //set the company being viewed in vuex\r\n    store.commit('explore/SET_VIEWED_COMPANY', JSON.parse(JSON.stringify(company)));\r\n\r\n    //navigate to view page with the necessary\r\n    return router.push({\r\n        name: 'explore.companies.view',\r\n        params: {\r\n            name_slug: company.name.toString().replace(\" \", \"-\"),\r\n        }\r\n    })\r\n}\r\n\r\nfunction confirmDelete(company){\r\n    ElMessageBox.prompt('Sure you want to delete this company?\\nPlease give a reason why you want to delete', 'Confirm Delete', {\r\n        confirmButtonText: 'Delete',\r\n        cancelButtonText: 'Cancel',\r\n        inputPlaceholder: \"Type here why you want to delete\",\r\n        inputValidator: (value)=> {\r\n            if(!value || !value.length){\r\n                return \"Please give a reason\";\r\n            }\r\n            return true;\r\n        },\r\n    })\r\n            .then(({ value }) => {\r\n                //define payload to send to api\r\n                let payload = {\r\n                    id: company.id,\r\n                    reason: value\r\n                };\r\n\r\n                //send payload to method handling the\r\n                deleteCompany(payload);\r\n            })\r\n            .catch(() => {})\r\n}\r\nfunction deleteCompany(payload){\r\n    //show loader\r\n    isLoading.value = true;\r\n\r\n    //make api call\r\n    api.post(apiRoutes.DELETE_EXPLORE_LISTED_COMPANY, payload)\r\n            .then(response => {\r\n                //delete the company entry from list of companies\r\n                //create copy of companies list\r\n                let companiesCopy = JSON.parse(JSON.stringify(companies.value));\r\n                //find the index of the entry that's been deleted\r\n                let deletedIndex = companiesCopy.findIndex(entry => entry.id == payload.id);\r\n                //delete the entry at that index\r\n                if(deletedIndex > -1){\r\n                    companiesCopy.splice(deletedIndex, 1);\r\n                    //write the updated copy to vuex companies list\r\n                    companies.value = companiesCopy;\r\n                }\r\n\r\n                //show success message\r\n                $.growl.notice({message: response.data.message});\r\n\r\n                //dismiss loader\r\n                isLoading.value = false;\r\n            })\r\n            .catch(error => isLoading.value = false)\r\n}\r\n\r\n//mounted hook\r\nonMounted(()=>{\r\n    //fetch companies\r\n    fetchCompanies();\r\n});\r\n\r\n</script>\r\n\r\n<template>\r\n\r\n    <div class=\"col-md-12 grid-margin stretch-card\">\r\n        <div class=\"card\" v-loading=\"isLoading\">\r\n            <div class=\"card-body\">\r\n                <h4 class=\"card-title\">Listed Companies</h4>\r\n                <router-link :to=\"{name: 'explore.companies.add'}\" class=\"btn btn-outline-secondary btn-icon-text\">\r\n                    <i class=\"fa fa-plus btn-icon-append\"></i>&nbsp;&nbsp;Add Company\r\n                </router-link>\r\n\r\n                <div class=\"table-responsive\" style=\"margin-top: 10px;\">\r\n                    <table class=\"table table-hover\">\r\n                        <thead>\r\n                        <tr>\r\n                            <th>Logo</th>\r\n                            <th>Name</th>\r\n                            <th>Desc</th>\r\n                            <th>Contact Person</th>\r\n                            <th>Actions</th>\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        <tr v-if=\"companies.length\" v-for=\"(company, index) in companies\"\r\n                            :key=\"'explore-companies-'+index\" @click=\"viewCompany(company)\">\r\n                            <td>\r\n                                <img style=\"max-height:150px;\" :src=\"company.logo\" :alt=\"company.name+'\\'s logo'\">\r\n                            </td>\r\n                            <td>{{ company.name }}</td>\r\n                            <td>{{ company.description }}</td>\r\n                            <td>{{ company.contact_name }}</td>\r\n                            <td>\r\n                                <button type=\"button\"\r\n                                        class=\"btn btn-outline-secondary btn-rounded btn-icon\"\r\n                                        style=\"margin-right:3px;\" @click=\"viewCompany(company)\">\r\n                                    <i class=\"mdi mdi-eye\"></i>\r\n                                </button>\r\n                                <!--<button type=\"button\" class=\"btn btn-outline-secondary btn-rounded btn-icon\" style=\"margin-right:3px;\">\r\n                                    <i class=\"mdi mdi-pencil\"></i>\r\n                                </button>-->\r\n                                <button type=\"button\"\r\n                                        @click=\"confirmDelete(company)\"\r\n                                        class=\"btn btn-danger btn-rounded btn-icon\">\r\n                                    <i class=\"mdi mdi-delete-forever\"></i>\r\n                                </button>\r\n                            </td>\r\n                        </tr>\r\n                        <tr v-else><td colspan=\"5\" class=\"text-center\">No data</td></tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</template>\r\n\r\n<style scoped>\r\n\r\n</style>","import script from \"./List.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./List.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["store","useStore","router","useRouter","isLoading","ref","companies","computed","get","state","explore","set","data","commit","fetchCompanies","value","length","api","apiRoutes","GET_EXPLORE_LISTED_COMPANIES","then","response","catch","error","viewCompany","company","JSON","parse","stringify","push","name","params","name_slug","toString","replace","confirmDelete","ElMessageBox","prompt","confirmButtonText","cancelButtonText","inputPlaceholder","inputValidator","payload","id","reason","deleteCompany","post","DELETE_EXPLORE_LISTED_COMPANY","companiesCopy","deletedIndex","findIndex","entry","splice","$","growl","notice","message","onMounted","__exports__"],"sourceRoot":""}