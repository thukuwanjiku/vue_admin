"use strict";(self["webpackChunkmyzola_admin"]=self["webpackChunkmyzola_admin"]||[]).push([[757],{9397:function(e,l,a){a.r(l),a.d(l,{default:function(){return Xe}});a(4114);var n=a(6768),t=a(144),i=a(5130),s=a(4232),d=a(782),u=a(1387),o=a(6133),r=a(5015),c=a(7021),m=a(1114),v=a(7477),p=a(7676),k=a(4373),g=a(1219),L=a(4300),f=a(7190);const _=e=>((0,n.Qi)("data-v-68d8b072"),e=e(),(0,n.jt)(),e),y={key:0,class:"row"},h={class:"col-sm-12 mb-3 d-inline-flex justify-content-end align-items-center"},b={class:"p-1"},x={class:"col-md-12"},w={class:"w-100 listing_carousel_primary_media"},R=["src"],F={class:"primary_indicator"},E={class:"col-md-12 m-t-20"},C={class:"mz-color"},S={class:"col-md-12 d-flex align-items-center"},A={class:"listing_company_logo"},N=["src","alt"],I={class:"m-0"},K={class:"m-0"},O={class:"col-md-12 m-t-20"},W=_((()=>(0,n.Lk)("h6",null,"Description",-1))),T=["innerHTML"],V={class:"col-md-12 m-t-20"},X=_((()=>(0,n.Lk)("h6",null,"Payments",-1))),M={key:0,class:"col-md-12 d-flex flex-wrap align-items-center"},P=_((()=>(0,n.Lk)("strong",null,"Mode",-1))),J=_((()=>(0,n.Lk)("br",null,null,-1))),H=_((()=>(0,n.Lk)("strong",null,"Amount",-1))),D=_((()=>(0,n.Lk)("br",null,null,-1))),U=_((()=>(0,n.Lk)("strong",null,"Reference",-1))),G=_((()=>(0,n.Lk)("br",null,null,-1))),Q=_((()=>(0,n.Lk)("strong",null,"Added",-1))),j={key:1,class:"col-md-12"},z=_((()=>(0,n.Lk)("small",{class:"text-italic text-muted"},"No payments added",-1))),B=[z],q={class:"col-md-12 m-t-20"},Y={class:"m-0"},Z={class:"col-md-12 m-b-20"},ee={class:"col-md-12 m-t-10 d-flex flex-wrap"},le=["onClick"],ae={class:"col-md-12 d-flex align-items-center"},ne=["src"],te={class:"m-0"},ie={class:"selected_indicator"},se=_((()=>(0,n.Lk)("i",{class:"ri ri-check-line"},null,-1))),de=[se],ue={class:"row"},oe={class:"col-md-6"},re={class:"col-md-6"},ce=_((()=>(0,n.Lk)("br",null,null,-1))),me={class:"col-md-12"},ve={class:"col-md-12 m-b-20"},pe=_((()=>(0,n.Lk)("h6",null,"Upload additional listing media here",-1))),ke={class:"p-l-10"},ge=_((()=>(0,n.Lk)("small",null,"Primary Media",-1))),Le=_((()=>(0,n.Lk)("br",null,null,-1))),fe={key:0,class:"m-t-5"},_e={class:"d-flex"},ye={class:"p-1 uploaded-image"},he=["src"],be=_((()=>(0,n.Lk)("i",{class:"ri ri-close-line"},null,-1))),xe=[be],we=_((()=>(0,n.Lk)("small",{class:"text-danger text-italic"},"*Will replace previous primary media",-1))),Re={class:"p-l-10 m-t-10"},Fe=_((()=>(0,n.Lk)("small",null,"Other Media",-1))),Ee=_((()=>(0,n.Lk)("br",null,null,-1))),Ce={class:"d-flex flex-wrap m-t-5"},Se=["src"],Ae=["onClick"],Ne=_((()=>(0,n.Lk)("i",{class:"ri ri-close-line"},null,-1))),Ie=[Ne],Ke=_((()=>(0,n.Lk)("br",null,null,-1))),Oe={class:"col-md-12"};var We={__name:"View",setup(e){const l=(0,d.Pj)(),_=(0,u.rd)(),z=((0,t.KR)(!1),(0,t.KR)(!1)),se=(0,t.KR)({}),be=(0,t.KR)([]),Ne=(0,t.KR)([]),We=(0,t.KR)({mode:null,amount:null,reference:null}),Te=(0,t.KR)(!1),Ve=(0,t.KR)(!1),Xe=(0,t.KR)(null),Me=(0,t.KR)(null),Pe=(0,t.KR)([]),Je=(0,t.KR)([]);function He(e){switch(e){case"add_payments":Te.value=!0;break;case"add_media":Ve.value=!0;break;case"edit":De();break}}function De(){return l.commit("exploreHub/STORE_EDIT_LISTING",JSON.parse(JSON.stringify(se.value))),_.replace({name:"explore_hub.listings.edit"})}function Ue(){k.A.get("/assets/PaymentModes.json").then((e=>Ne.value=e.data.map((e=>(e.image=a(1707)(`./${e.image}`),e)))))}function Ge(){if(!We.value.mode||!We.value.mode.length)return g.nk.warning("Please select a payment mode");if(!We.value.amount||!We.value.amount.toString().length)return g.nk.warning("Please enter the payment amount");if(isNaN(We.value.amount))return g.nk.warning("Please enter a valid amount");let e={id:se.value.id,payments:[JSON.parse(JSON.stringify(We.value))]};z.value=!0,L.A.post(f.pe.EXPLORE_HUB_ADD_LISTING_PAYMENTS,e).then((e=>{$.growl.notice({message:e.data.message}),se.value=e.data.data,Te.value=!1,z.value=!1;let a=JSON.parse(JSON.stringify(l.state.exploreHub.activeListings)),n=a.findIndex((l=>l.id==e.data.data.id));n>-1&&(a[n]=e.data.data,l.commit("exploreHub/STORE_ACTIVE_LISTINGS",a))})).catch((e=>z.value=!1))}function $e(e){const l=e.target.files[0],a=new FileReader;a.onload=e=>{Xe.value=e.target.result,Me.value=l},a.readAsDataURL(l),$("#primaryListingMedia").val("")}function Qe(e){const l=e.target.files;for(let a=0;a<l.length;a++){const e=l[a],n=new FileReader;n.onload=l=>{Pe.value.push({name:e.name,url:l.target.result}),Je.value.push(e)},n.readAsDataURL(e)}$("#listingMedia").val("")}function je(){Xe.value=null,Me.value=null}function ze(e){Pe.value.splice(e,1),Je.value.splice(e,1)}function Be(){if(!Me.value&&!Je.value.length)return g.nk.warning("Please upload images to save");let e=new FormData;if(e.append("id",se.value.id),Me.value&&e.append("primary_media",Me.value),Je.value.length)for(let l=0;l<Je.value.length;l++)e.append(`media[${l}]`,Je.value[l]);z.value=!0,L.A.post(f.pe.EXPLORE_HUB_ADD_LISTING_MEDIA,e).then((e=>{$.growl.notice({message:e.data.message}),se.value=e.data.data,Ve.value=!1,z.value=!1;let a=JSON.parse(JSON.stringify(l.state.exploreHub.activeListings)),n=a.findIndex((l=>l.id==e.data.data.id));n>-1&&(a[n]=e.data.data,l.commit("exploreHub/STORE_ACTIVE_LISTINGS",a))})).catch((e=>z.value=!1))}return(0,n.sV)((()=>{if(null==l.state.exploreHub.viewedListing)return _.back();se.value=JSON.parse(JSON.stringify(l.state.exploreHub.viewedListing)),be.value=JSON.parse(JSON.stringify(se.value.media)),Ue(),setTimeout((()=>{$(".listing_desc > p > span").css("background","inherit")}),500)})),(e,l)=>{const a=(0,n.g2)("el-icon"),d=(0,n.g2)("el-button"),u=(0,n.g2)("el-dropdown-item"),k=(0,n.g2)("el-dropdown-menu"),g=(0,n.g2)("el-dropdown"),L=(0,n.g2)("el-input"),f=(0,n.g2)("el-dialog"),_=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)(n.FK,null,[Object.keys(se.value).length?((0,n.uX)(),(0,n.CE)("div",y,[(0,n.Lk)("div",h,[(0,n.Lk)("div",b,[(0,n.bF)(g,{trigger:"click",onCommand:He},{dropdown:(0,n.k6)((()=>[(0,n.bF)(k,null,{default:(0,n.k6)((()=>[(0,n.bF)(u,{command:"edit",icon:(0,t.R1)(v.ffu)},{default:(0,n.k6)((()=>[(0,n.eW)("Edit Listing")])),_:1},8,["icon"]),(0,n.bF)(u,{command:"add_payments",icon:(0,t.R1)(v.v0_)},{default:(0,n.k6)((()=>[(0,n.eW)("Add Payment")])),_:1},8,["icon"]),(0,n.bF)(u,{command:"add_media",icon:(0,t.R1)(v.F46)},{default:(0,n.k6)((()=>[(0,n.eW)("Add Media")])),_:1},8,["icon"])])),_:1})])),default:(0,n.k6)((()=>[(0,n.bF)(d,{plain:"",size:"small"},{default:(0,n.k6)((()=>[(0,n.eW)(" Actions"),(0,n.bF)(a,{class:"el-icon--right"},{default:(0,n.k6)((()=>[(0,n.bF)((0,t.R1)(v.yd$))])),_:1})])),_:1})])),_:1})]),(0,n.bF)(o.A)]),(0,n.Lk)("div",x,[(0,n.bF)((0,t.R1)(m.FN),{itemsToShow:2,wrapAround:!0,transition:500,autoplay:2e3},{addons:(0,n.k6)((()=>[(0,n.bF)((0,t.R1)(m.Vx)),(0,n.bF)((0,t.R1)(m.dK))])),default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(se.value.media,((e,l)=>((0,n.uX)(),(0,n.Wv)((0,t.R1)(m.q7),{key:"view-listing-media-"+e.id},{default:(0,n.k6)((()=>[(0,n.Lk)("div",w,[(0,n.Lk)("img",{src:e.path,class:"d-block w-100 carousel__item"},null,8,R),(0,n.bo)((0,n.Lk)("div",F,"primary",512),[[i.aG,e.is_primary]])])])),_:2},1024)))),128))])),_:1})]),(0,n.Lk)("div",E,[(0,n.Lk)("h5",C,(0,s.v_)(se.value.title),1)]),(0,n.Lk)("div",S,[(0,n.Lk)("div",A,[(0,n.Lk)("img",{src:se.value.company.logo,alt:se.value.company.name+"'s logo"},null,8,N)]),(0,n.Lk)("div",null,[(0,n.Lk)("h6",I,(0,s.v_)(se.value.company.name),1),(0,n.Lk)("h6",K,[(0,n.Lk)("small",null,(0,s.v_)(se.value.company.description),1)])])]),(0,n.Lk)("div",O,[W,(0,n.Lk)("div",{class:"alert alert-secondary alert-dismissible fade show listing_desc",role:"alert",innerHTML:se.value.description},null,8,T)]),(0,n.Lk)("div",V,[X,se.value.payments.length?((0,n.uX)(),(0,n.CE)("div",M,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(se.value.payments,(e=>((0,n.uX)(),(0,n.CE)("div",{class:"p-1 view_listing_payment",key:"listing-payment-"+e.id},[(0,n.Lk)("small",null,[P,(0,n.eW)(": "+(0,s.v_)((0,t.R1)(r.A)(e.mode))+" ",1),J,H,(0,n.eW)(": "+(0,s.v_)((0,t.R1)(c.RL)(e.amount,"KES")),1),D,U,(0,n.eW)(": "),(0,n.bo)((0,n.Lk)("template",null,[(0,n.eW)((0,s.v_)(e.reference),1)],512),[[i.aG,e.reference&&e.reference.length&&e.reference!=e.mode]]),G,Q,(0,n.eW)(": "+(0,s.v_)(e.added_at),1)])])))),128))])):(0,n.Q3)("",!0),se.value.payments.length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",j,B))]),(0,n.Lk)("div",q,[(0,n.Lk)("p",Y,[(0,n.eW)((0,s.v_)(se.value.start_date_desc)+" ",1),(0,n.Lk)("strong",null,(0,s.v_)(se.value.start_at_formatted),1),(0,n.eW)("  -  "),(0,n.Lk)("strong",null,(0,s.v_)(se.value.end_at_formatted),1)])])])):(0,n.Q3)("",!0),(0,n.bF)(f,{"custom-class":"el-dialog-width",width:"45%",fullscreen:(0,t.R1)(c.Qv),modelValue:Te.value,"onUpdate:modelValue":l[2]||(l[2]=e=>Te.value=e)},{default:(0,n.k6)((()=>[(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",Z,[(0,n.bF)(p.A,null,{default:(0,n.k6)((()=>[(0,n.eW)("Select Payment Mode")])),_:1}),(0,n.Lk)("div",ee,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Ne.value,(e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,s.C4)(["p-1 payment-mode hov-pointer",{selected:e.name==We.value.mode}]),key:"all-payment-modes-"+e.name,onClick:l=>We.value.mode=e.name},[(0,n.Lk)("div",ae,[(0,n.Lk)("img",{src:e.image,style:{"max-width":"40px","max-height":"20px"}},null,8,ne),(0,n.eW)("    "),(0,n.Lk)("h6",te,(0,s.v_)((0,t.R1)(r.A)(e.name)),1)]),(0,n.bo)((0,n.Lk)("div",ie,de,512),[[i.aG,We.value.mode==e.name]])],10,le)))),128))])]),(0,n.Lk)("div",ue,[(0,n.Lk)("div",oe,[(0,n.bF)(p.A,null,{default:(0,n.k6)((()=>[(0,n.eW)("Payment Amount")])),_:1}),(0,n.bF)(L,{placeholder:"Enter payment amount",modelValue:We.value.amount,"onUpdate:modelValue":l[0]||(l[0]=e=>We.value.amount=e)},null,8,["modelValue"])]),(0,n.Lk)("div",re,[(0,n.bF)(p.A,null,{default:(0,n.k6)((()=>[(0,n.eW)("Transaction Reference")])),_:1}),(0,n.bF)(L,{placeholder:"Enter reference code",modelValue:We.value.reference,"onUpdate:modelValue":l[1]||(l[1]=e=>We.value.reference=e)},null,8,["modelValue"])])]),ce,(0,n.Lk)("div",me,[(0,n.bF)(d,{type:"primary",onClick:Ge},{default:(0,n.k6)((()=>[(0,n.eW)("Add Payment")])),_:1})])])),[[_,z.value]])])),_:1},8,["fullscreen","modelValue"]),(0,n.bF)(f,{"custom-class":"el-dialog-width",width:"45%",fullscreen:(0,t.R1)(c.Qv),modelValue:Ve.value,"onUpdate:modelValue":l[3]||(l[3]=e=>Ve.value=e)},{default:(0,n.k6)((()=>[(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",ve,[pe,(0,n.Lk)("div",ke,[ge,Le,(0,n.Lk)("input",{style:{"max-width":"400px"},type:"file",class:"form-control",id:"primaryListingMedia",onChange:$e},null,32),null!=Xe.value?((0,n.uX)(),(0,n.CE)("div",fe,[(0,n.Lk)("div",_e,[(0,n.Lk)("div",ye,[(0,n.Lk)("img",{src:Xe.value,style:{"max-width":"80px","max-height":"60px"}},null,8,he),(0,n.Lk)("div",{class:"remover",onClick:je},xe)])]),we])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",Re,[Fe,Ee,(0,n.Lk)("input",{style:{"max-width":"400px"},type:"file",multiple:"",class:"form-control",id:"listingMedia",onChange:Qe},null,32),(0,n.Lk)("div",Ce,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Pe.value,((e,l)=>((0,n.uX)(),(0,n.CE)("div",{class:"p-1 uploaded-image",key:"uploaded-media-"+l},[(0,n.Lk)("img",{src:e.url,style:{"max-width":"80px","max-height":"60px"}},null,8,Se),(0,n.Lk)("div",{class:"remover",onClick:e=>ze(l)},Ie,8,Ae)])))),128))])])]),Ke,(0,n.Lk)("div",Oe,[(0,n.bF)(d,{type:"primary",onClick:Be},{default:(0,n.k6)((()=>[(0,n.eW)("Save Media")])),_:1})])])),[[_,z.value]])])),_:1},8,["fullscreen","modelValue"])],64)}}},Te=a(1241);const Ve=(0,Te.A)(We,[["__scopeId","data-v-68d8b072"]]);var Xe=Ve}}]);
//# sourceMappingURL=757.js.map