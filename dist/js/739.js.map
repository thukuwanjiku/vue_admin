{"version":3,"file":"js/739.js","mappings":"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","sources":["webpack://myzola-admin/./src/views/explore_hub/companies/listed/Add.vue","webpack://myzola-admin/./src/views/explore_hub/companies/listed/Add.vue?e393"],"sourcesContent":["<script setup>\n\nimport {useRouter} from \"vue-router\";\nimport {onMounted, ref, computed} from \"vue\";\nimport api from \"@/services/api\";\nimport {apiRoutes} from \"@/services/apiRoutes\";\nimport {useStore} from \"vuex\";\nimport CloseButton from \"@/components/CloseButton.vue\";\nimport { VueTelInput } from 'vue-tel-input';\nimport 'vue-tel-input/vue-tel-input.css';\nimport {startCase} from \"lodash-es\";\nimport {checkHasPermission, isSmallScreen, socialPlatforms} from \"@/services/Helpers\";\nimport {validateSocialHandle} from \"@/services/SocialHandlesLinksValidator\";\nimport {ElMessage} from \"element-plus\";\nimport SocialHandle from \"@/components/SocialHandle.vue\";\n\n/* ------------------------------\n* Variables & Properties\n* ------------------------------\n* */\nconst router = useRouter();\nconst store = useStore();\n\nconst company = ref({\n    name:\"\",\n    description:\"\",\n    contact_name:\"\",\n    contact_phone:\"\",\n    email:\"\",\n    about:\"\",\n});\nconst addedSocials = ref([]);\nconst newSocialHandle = ref({platform:\"\", link:\"\"});\n\nlet logoUpload = ref(null);\nlet logoFile = ref(null);\n\nlet bannerUpload = ref(null);\nlet bannerFile = ref(null);\n\nconst isLoading = ref(false);\nconst isAddingSocialHandles = ref(false);\nlet aboutQuillEditor = ref(null);\n\n\n/* ------------------------------\n* Computed Properties\n* ------------------------------\n* */\nconst availableSocials = computed(()=>{\n    //get socials already added to the company\n    let alreadyAddedSocials = addedSocials.value.map(entry => entry.platform);\n    return socialPlatforms.filter(entry => !alreadyAddedSocials.includes(entry));\n});\n\n\n\n/* ------------------------------\n* Lifecycle Hooks\n* ------------------------------\n* */\nonMounted(()=>{\n    aboutQuillEditor = new Quill('#addCompanyAboutEditor', {\n        theme: 'snow',\n        placeholder: 'Enter company about here'\n    });\n\n    aboutQuillEditor.on('text-change', () => {\n        let aboutLength = aboutQuillEditor.getLength();\n    });\n});\n\n/* ------------------------------\n* Methods & functions\n* ------------------------------\n* */\nfunction processUpload(event){\n    logoUpload.value = event.target.files[0];\n\n    const file = event.target.files[0];\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n        logoFile.value = e.target.result;\n    };\n    reader.readAsDataURL(file);\n}\n\nfunction bannerProcessUpload(event) {\n  bannerUpload.value = event.target.files[0];\n\n  const file = event.target.files[0];\n  const reader = new FileReader();\n\n  reader.onload = (e) => {\n    bannerFile.value = e.target.result;\n  };\n  reader.readAsDataURL(file);\n}\n\nfunction removeUpload(){\n    logoUpload.value = null;\n    logoFile.value = null;\n    $(\"#companyLogo\").val(\"\");\n}\n\nfunction removeBannerUpload() {\n  bannerUpload.value = null;\n  bannerFile.value = null;\n  $(\"#companyBanner\").val(\"\");\n}\n\nfunction selectSocialPlatform(social){\n    newSocialHandle.value.platform = social;\n    //if social platform is whatsapp, prefill the link field with whatsapp api link\n    newSocialHandle.value.link = social == 'whatsapp' ? \"https://wa.me/\" : \"\";\n}\n\nfunction addSocial(){\n    if(newSocialHandle.value.platform != 'whatsapp')\n        newSocialHandle.value.link = newSocialHandle.value.link.replace(/\\/+$/, '');\n\n    //validate link entered\n    if(!validateSocialHandle(newSocialHandle.value))\n        return ElMessage.warning(`Please enter a valid ${startCase(newSocialHandle.value.platform)} url`);\n\n    //add new social to company list of socials\n    addedSocials.value.push({\n        platform: newSocialHandle.value.platform,\n        link: newSocialHandle.value.link\n    });\n    //reset new social handle details\n    newSocialHandle.value = {platform: \"\", link: \"\"};\n}\n\nfunction submit(){\n    //validate that company about is provided\n    let about = aboutQuillEditor.getSemanticHTML();\n    if(!about || !about.toString().length || about == \"<p></p>\") {\n        return $.growl.warning({message: \"Please enter the company's bio\"})\n    }\n    company.value['about'] = about;\n\n    //validate that phone number is entered\n    if(!company.value.contact_phone || !company.value.contact_phone.toString().length) {\n        return $.growl.warning({message: \"Please enter contact phone\"})\n    }\n\n    //prepare request payload\n    let payload = new FormData();\n    //add all company details to the form data\n    Object.keys(company.value)\n            .forEach(key => {\n                let value = company.value[key];\n                if(key == 'contact_phone') value = value.toString().replaceAll(\" \", \"\");\n                payload.append(key, value)\n            });\n\n    //add logo to payload\n    payload.append('company_logo', logoUpload.value);\n\n    //add banner to payload\n    payload.append('company_banner', bannerUpload.value);\n\n    //where company socials are specified, add them to form data\n    if(addedSocials.value.length){\n        addedSocials.value.forEach((social, index) => {\n            payload.append(`socials[${index}][platform]`, social.platform);\n            payload.append(`socials[${index}][link]`, social.link);\n        });\n    }\n\n    //SHOW LOADER\n    isLoading.value = true;\n\n    //make api call\n    api.post(apiRoutes.ADD_EXPLORE_LISTED_COMPANY, payload).then(response => {\n        //show success response\n        $.growl.notice({message: response.data.message});\n\n        //get a copy of current companies list\n        let companies = JSON.parse(JSON.stringify(store.state.exploreHub.companies));\n        //add the new company to the copy\n        companies.unshift(response.data.data);\n        //overwrite the vuex companies list with the updated copy\n        store.commit('exploreHub/STORE_EXPLORE_LISTED_COMPANIES', companies)\n\n        //DISMISS LOADER\n        isLoading.value = false;\n\n        //navigate back to companies list\n        router.back();\n    }).catch(error => {\n        isLoading.value = false\n        $.growl.notice({error: error.response?.data?.message ?? error.message ?? \"An error occurred\"});\n    });\n}\n\n</script>\n\n<template>\n\n    <div class=\"col-sm-12 mb-3 d-inline-flex align-items-center justify-content-between\">\n        <h6 class=\"fw-bold mb-0\" style=\"margin-left: 20px;\">Add a new Company</h6>\n        <close-button></close-button>\n    </div>\n\n    <form @submit.prevent=\"submit\" v-loading=\"isLoading\">\n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <!-- Logo -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"text\" class=\"form-control\" id=\"companyName\"\n                               placeholder=\"Company Name\" v-model=\"company.name\" required>\n                        <label for=\"companyName\">Company Name</label>\n                    </div>\n                </div>\n\n                <!-- Tagline -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"text\" class=\"form-control\" id=\"companyTagline\"\n                               placeholder=\"Tagline\" v-model=\"company.description\"\n                               maxlength=\"100\" required>\n                        <label for=\"companyTagline\">Tagline</label>\n\n                        <div v-if=\"company.description.toString().length\" class=\"d-flex justify-content-end character_count_indicator\">\n                            {{ company.description.toString().length }}/100\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Contact Person -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"text\" class=\"form-control\" id=\"companyContactPerson\"\n                               placeholder=\"Company Person\" v-model=\"company.contact_name\" required>\n                        <label for=\"companyContactPerson\">Contact Person</label>\n                    </div>\n                </div>\n\n                <!-- Contact Phone -->\n                <div class=\"col-md-10 m-b-20\">\n                    <small class=\"text-muted\">Contact Phone</small>\n                    <vue-tel-input\n                            v-model=\"company.contact_phone\"\n                            mode=\"international\"></vue-tel-input>\n                </div>\n\n                <!-- Contact Email -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"email\" class=\"form-control\" id=\"companyContactEmail\"\n                               placeholder=\"Email\" v-model=\"company.email\" required>\n                        <label for=\"companyContactEmail\">Email</label>\n                    </div>\n                </div>\n\n                <!-- About -->\n                <div class=\"col-md-10 m-b-20\">\n                    <h6>Company's Bio (About)</h6>\n\n                    <!-- Quill Editor Default -->\n                    <div id=\"addCompanyAboutEditor\" class=\"quill-editor-default\">\n                    </div>\n                    <!-- End Quill Editor Default -->\n\n\n                </div>\n            </div>\n            <div class=\"col-md-6\">\n                <!-- Logo -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"file\" class=\"form-control\" id=\"companyLogo\" @change=\"processUpload\" accept=\".png,.jpg,.jpeg,.gif\">\n                        <label for=\"companyLogo\">Company Logo</label>\n                    </div>\n\n                    <div class=\"d-flex flex-wrap m-t-10\" v-if=\"logoFile\">\n                        <div class=\"p-1 uploaded-image\">\n                            <img :src=\"logoFile\"  style=\"max-width:80px;max-height:60px;\">\n                            <div class=\"remover\" @click=\"removeUpload\">\n                                <i class=\"ri ri-close-line\"></i>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n              <!-- Company Banner -->\n              <div class=\"col-md-10 m-b-20\">\n                <div class=\"form-floating\">\n                  <input type=\"file\" class=\"form-control\" id=\"companyBanner\" @change=\"bannerProcessUpload\" accept=\".png,.jpg,.jpeg,.gif\">\n                  <label for=\"companyBanner\">Company Banner</label>\n                </div>\n\n                <div class=\"d-flex flex-wrap m-t-10\" v-if=\"bannerFile\">\n                  <div class=\"p-1 uploaded-image\">\n                    <img :src=\"bannerFile\"  style=\"max-width:80px;max-height:60px;\">\n                    <div class=\"remover\" @click=\"removeBannerUpload\">\n                      <i class=\"ri ri-close-line\"></i>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n                <!-- Socials -->\n                <div class=\"col-md-10 m-b-20\">\n                    <h6>Social Media Handles</h6>\n                    <div class=\"d-inline-flex align-items-center flex-wrap\">\n                        <div v-if=\"addedSocials.length\" class=\"d-inline-flex\">\n                            <social-handle v-for=\"(social, index) in addedSocials\"\n                                           :key=\"'form-current-socials-'+index\"\n                                           v-bind=\"social\"></social-handle>\n                        </div>\n                        <el-button @click=\"isAddingSocialHandles = !isAddingSocialHandles\" size=\"small\" round>\n                            <i class=\"ri ri-add-line\" v-if=\"!addedSocials.length\"></i>{{ addedSocials.length ? \"Click to edit\" : \"Click to add\" }}\n                        </el-button>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n\n        <hr>\n        <div class=\"modal-footer\">\n            <button class=\"btn btn-primary\" type=\"submit\" v-if=\"checkHasPermission('explore_hub.companies.add')\">Add Company</button>\n            &nbsp;\n            <button @click=\"router.back()\" class=\"btn btn-secondary\" type=\"button\">Cancel</button>\n        </div>\n    </form>\n\n    <!-- Modal to add company socials -->\n    <el-dialog\n            :fullscreen=\"isSmallScreen\"\n            v-model=\"isAddingSocialHandles\">\n        <div class=\"row\" v-if=\"addedSocials.length\">\n            <h6 class=\"fw-bold\">\n                <small class=\"text-muted\">Currently added</small>\n            </h6>\n            <small class=\"text-muted text-italic\">Click to remove</small>\n            <div class=\"d-inline-flex\">\n                <div class=\"p-1\" @click=\"addedSocials.splice(index,1)\"\n                     v-for=\"(social, index) in addedSocials\" :key=\"'current-socials-'+index\">\n                    <social-handle :platform=\"social.platform\"></social-handle>\n                </div>\n            </div>\n        </div>\n        <br>\n        <div class=\"row\">\n            <h6 class=\"fw-bold\" v-if=\"addedSocials.length\">\n                <small class=\"text-muted\">Add more here</small>\n            </h6>\n            <div class=\"p-l-20\">\n                <form @submit.prevent=\"addSocial\">\n                    <p><small>Select Platform</small></p>\n                    <div class=\"d-inline-flex flex-wrap\">\n                        <template v-for=\"(social, index) in availableSocials\"\n                                  :key=\"'to-add-social'+index\">\n                            <div @click=\"selectSocialPlatform(social)\" v-if=\"social == newSocialHandle.platform\">\n                                <el-badge value=\"✓\" class=\"item\" type=\"primary\">\n                                    <social-handle :platform=\"social\"></social-handle>\n                                </el-badge>\n                            </div>\n                            <div @click=\"selectSocialPlatform(social)\" v-else>\n                                <social-handle :platform=\"social\"></social-handle>\n                            </div>\n                        </template>\n                    </div>\n                    <br><br>\n                    <div class=\"col-md-6\" v-if=\"newSocialHandle.platform.length\">\n                        <div class=\"input-group mb-3\">\n                            <div class=\"form-floating\">\n                                <input type=\"text\" class=\"form-control\" id=\"newSocialLink\"\n                                       placeholder=\"Tagline\" v-model=\"newSocialHandle.link\" required>\n                                <label for=\"newSocialLink\">\n                                    <template v-if=\"newSocialHandle.platform == 'whatsapp'\">\n                                        Enter Whatsapp number\n                                    </template>\n                                    <template v-else>\n                                        Enter {{ startCase(newSocialHandle.platform) }} Link here\n                                    </template>\n                                </label>\n                            </div>\n                            <span class=\"input-group-text\" id=\"basic-addon2\">\n                                <el-button native-type=\"submit\" link>Add</el-button>\n                            </span>\n                        </div>\n                        <small v-if=\"newSocialHandle.platform == 'whatsapp'\">Please enter the whatsapp number in international format (+254712345678)</small>\n                    </div>\n                </form>\n            </div>\n            <div class=\"col-sm-12 d-flex justify-content-end\">\n                <el-button type=\"primary\" @click=\"isAddingSocialHandles = !isAddingSocialHandles\">Close</el-button>\n            </div>\n        </div>\n    </el-dialog>\n\n</template>\n\n\n<style scoped>\n\n</style>\n","import script from \"./Add.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Add.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["router","useRouter","store","useStore","company","ref","name","description","contact_name","contact_phone","email","about","addedSocials","newSocialHandle","platform","link","logoUpload","logoFile","bannerUpload","bannerFile","isLoading","isAddingSocialHandles","aboutQuillEditor","availableSocials","computed","alreadyAddedSocials","value","map","entry","socialPlatforms","filter","includes","processUpload","event","target","files","file","reader","FileReader","onload","e","result","readAsDataURL","bannerProcessUpload","removeUpload","$","val","removeBannerUpload","selectSocialPlatform","social","addSocial","replace","validateSocialHandle","ElMessage","warning","startCase","push","submit","getSemanticHTML","toString","length","growl","message","payload","FormData","Object","keys","forEach","key","replaceAll","append","index","api","post","apiRoutes","ADD_EXPLORE_LISTED_COMPANY","then","response","notice","data","companies","JSON","parse","stringify","state","exploreHub","unshift","commit","back","catch","error","onMounted","Quill","theme","placeholder","on","getLength","__exports__"],"sourceRoot":""}