"use strict";(self["webpackChunkmyzola_admin"]=self["webpackChunkmyzola_admin"]||[]).push([[317],{5317:function(e,t,s){s.r(t),s.d(t,{default:function(){return oe}});var a=s(6768),c=s(144),n=s(4232),i=s(5130),o=s(4300),l=s(7190),d=s(782),m=s(7021);const r=e=>((0,a.Qi)("data-v-e4824a92"),e=e(),(0,a.jt)(),e),_=r((()=>(0,a.Lk)("div",{class:"row"},[(0,a.Lk)("div",{class:"col-md-12 mb-4"},[(0,a.Lk)("h4",{class:"font-weight-bold"},"Customer Chats")])],-1))),E={class:"row"},v={class:"col-md-3"},u={class:"card p-4"},S={key:0},k=r((()=>(0,a.Lk)("div",{class:"d-flex flex-column justify-content-center align-items-center"},[(0,a.Lk)("div",{class:"spinner-border text-primary"}),(0,a.Lk)("p",{class:"mt-2"},"Loading conversations. Please wait...")],-1))),C=[k],p={key:1},h=["onClick"],T={class:"me-3"},L=["src","alt"],g={class:"fw-bold text-dark mb-0"},R={class:"mb-0 text-dark text-md mb-2"},O={class:"text-muted"},N={class:"col-md-9"},I={key:0},b=r((()=>(0,a.Lk)("div",{class:"d-flex flex-column justify-content-center align-items-center"},[(0,a.Lk)("div",{class:"spinner-border text-primary"}),(0,a.Lk)("p",{class:"mt-2"},"Loading messages. Please wait...")],-1))),y=[b],f={key:1},x={class:"card"},A={key:0},w={class:"d-flex p-4"},M={class:"me-3"},V=["src","alt"],G={class:"fw-bold text-dark mb-0"},X={class:"mb-0 text-dark"},F=r((()=>(0,a.Lk)("hr",{class:"my-0"},null,-1))),U={key:0},W={key:0,class:"d-flex justify-content-start mb-4"},j={class:"message-container"},H={class:"message-time"},D={key:1,class:"d-flex justify-content-end mb-4"},K={class:"message-container-send"},P={class:"message-time-send"},z={key:1},Q={class:"d-flex flex-col justify-content-center align-items-center py-4"},J=r((()=>(0,a.Lk)("img",{src:"/img/no_data.svg",alt:"Chat Illustration",class:"mb-4",width:"250px"},null,-1))),q={class:"fw-medium"},B=r((()=>(0,a.Lk)("hr",{class:"my-0"},null,-1))),Y={class:"p-3"},Z={class:"d-flex"},ee=["disabled"],te={key:1},se=r((()=>(0,a.Lk)("div",{class:"d-flex flex-col justify-content-center align-items-center py-4"},[(0,a.Lk)("img",{src:"/img/chat_illustration.svg",alt:"Chat Illustration",class:"mb-4",width:"250px"}),(0,a.Lk)("p",{class:"fw-medium"},"Click on a conversation to check messages.")],-1))),ae=[se];var ce={__name:"ChatWithCustomers",setup(e){const t=(0,d.Pj)(),s=(0,c.KR)({message:"",conversation_id:""}),r=(0,c.KR)(!1);let k=(0,a.EW)({get:()=>t.state.chat.conversations,set:e=>t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e)}),b=(0,a.EW)({get:()=>t.state.chat.isFetchingCustomerConversations,set:e=>t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",e)}),se=(0,a.EW)({get:()=>t.state.chat.isFetchingConversationMessages,set:e=>t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",e)}),ce=(0,a.EW)({get:()=>t.state.chat.selectedConversation,set:e=>t.commit("chat/SET_SELECTED_CONVERSATION",e)}),ne=(0,a.EW)({get:()=>t.state.chat.messages,set:e=>t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e)});(0,a.sV)((()=>{ie()}));const ie=()=>{t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!0),o.A.get(l.pe.GET_CUSTOMER_CONVERSATIONS).then((e=>{t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e.data.data),t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!1)})).catch((e=>{t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!1)}))},oe=e=>{t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!0),o.A.post(l.pe.GET_CONVERSATION_MESSAGES,{conversation_id:e.conversation_id}).then((s=>{t.commit("chat/SET_SELECTED_CONVERSATION",e),t.commit("chat/STORE_CONVERSATION_MESSAGES",s.data.data),t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!1)})).catch((e=>{t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!1)}))},le=()=>{r.value=!0,s.value.conversation_id=t.state.chat.selectedConversation.conversation_id;let e=new FormData;e.append("message",s.value.message),e.append("conversation_id",s.value.conversation_id),o.A.post(l.pe.SEND_MESSAGE_TO_CUSTOMER,e).then((e=>{$.growl.notice({message:e.data}),r.value=!1})).catch((e=>{r.value=!1}))};return(e,t)=>((0,a.uX)(),(0,a.CE)("div",null,[_,(0,a.Lk)("div",E,[(0,a.Lk)("div",v,[(0,a.Lk)("div",u,[(0,c.R1)(b)?((0,a.uX)(),(0,a.CE)("div",S,C)):((0,a.uX)(),(0,a.CE)("div",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,c.R1)(k),((e,t)=>((0,a.uX)(),(0,a.CE)("a",{href:"#",onClick:t=>oe(e),class:(0,n.C4)(["d-flex p-3 chat-box",{"border-bottom":(0,c.R1)(k).length>1}]),key:`conversation-${e.id}`},[(0,a.Lk)("div",T,[(0,a.Lk)("img",{src:e.conversation.data.customer_photo,class:"rounded-circle",style:{width:"60px"},alt:e.conversation.data.customer_name},null,8,L)]),(0,a.Lk)("div",null,[(0,a.Lk)("p",g,(0,n.v_)(e.conversation.data.customer_name),1),(0,a.Lk)("p",R,(0,n.v_)(e.conversation.last_message?(0,c.R1)(m.f7)(e.conversation.last_message.body):"Start Message"),1),(0,a.Lk)("small",O,(0,n.v_)(e.conversation.last_message?(0,c.R1)(m.kp)(e.conversation.last_message.updated_at):""),1)])],10,h)))),128))]))])]),(0,a.Lk)("div",N,[(0,c.R1)(se)?((0,a.uX)(),(0,a.CE)("div",I,y)):((0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",x,[(0,c.R1)(ce)?((0,a.uX)(),(0,a.CE)("div",A,[(0,a.Lk)("div",w,[(0,a.Lk)("div",M,[(0,a.Lk)("img",{src:(0,c.R1)(ce).conversation.data.customer_photo,class:"rounded-circle",style:{width:"60px"},alt:(0,c.R1)(ce).conversation.data.customer_name},null,8,V)]),(0,a.Lk)("div",null,[(0,a.Lk)("p",G,(0,n.v_)((0,c.R1)(ce).conversation.data.customer_name),1),(0,a.Lk)("p",X,(0,n.v_)((0,c.R1)(ce).conversation.data.customer_email),1)])]),F,(0,a.Lk)("div",null,[(0,c.R1)(ne).length>0?((0,a.uX)(),(0,a.CE)("div",U,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,c.R1)(ne),(e=>((0,a.uX)(),(0,a.CE)("div",{class:"py-4 px-3",key:`chat-${(0,c.R1)(ce).id}-message-${e.id}`},[e.is_sender?e.is_sender?((0,a.uX)(),(0,a.CE)("div",D,[(0,a.Lk)("div",K,[(0,a.eW)((0,n.v_)(e.body)+" ",1),(0,a.Lk)("span",P,(0,n.v_)((0,c.R1)(m.kp)(e.created_at)),1)])])):(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",W,[(0,a.Lk)("div",j,[(0,a.eW)((0,n.v_)(e.body)+" ",1),(0,a.Lk)("span",H,(0,n.v_)((0,c.R1)(m.kp)(e.created_at)),1)])]))])))),128))])):((0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("div",Q,[J,(0,a.Lk)("p",q,[(0,a.eW)("No messages present between you and "),(0,a.Lk)("b",null,(0,n.v_)((0,c.R1)(ce).conversation.data.customer_name),1),(0,a.eW)(".")])])]))]),B,(0,a.Lk)("div",Y,[(0,a.Lk)("form",{onSubmit:(0,i.D$)(le,["prevent"])},[(0,a.Lk)("div",Z,[(0,a.bo)((0,a.Lk)("input",{class:"form-control me-3 border-0 border-bottom send-text-input rounded-0","onUpdate:modelValue":t[0]||(t[0]=e=>s.value.message=e),placeholder:"Start typing"},null,512),[[i.Jo,s.value.message]]),(0,a.Lk)("button",{class:"btn btn-primary",type:"submit",disabled:r.value},"Send",8,ee)])],32)])])):((0,a.uX)(),(0,a.CE)("div",te,ae))])]))])])]))}},ne=s(1241);const ie=(0,ne.A)(ce,[["__scopeId","data-v-e4824a92"]]);var oe=ie}}]);
//# sourceMappingURL=317.js.map