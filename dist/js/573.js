"use strict";(self["webpackChunkmyzola_admin"]=self["webpackChunkmyzola_admin"]||[]).push([[573],{8954:function(e,t,s){s.r(t),s.d(t,{default:function(){return le}});var a=s(6768),c=s(144),n=s(4232),o=s(5130),i=s(4300),l=s(7190),d=s(782),r=s(7021);const m=e=>((0,a.Qi)("data-v-67899980"),e=e(),(0,a.jt)(),e),E=m((()=>(0,a.Lk)("div",{class:"row"},[(0,a.Lk)("div",{class:"col-md-12 mb-4"},[(0,a.Lk)("h4",{class:"font-weight-bold"},"Customer Chats")])],-1))),_={class:"row"},S={class:"col-md-3"},v={class:"card p-4"},u={key:0},k=m((()=>(0,a.Lk)("div",{class:"d-flex flex-column justify-content-center align-items-center"},[(0,a.Lk)("div",{class:"spinner-border text-primary"}),(0,a.Lk)("p",{class:"mt-2"},"Loading conversations. Please wait...")],-1))),C=[k],p={key:1},h=["onClick"],T={class:"me-3"},g=["src","alt"],O={class:"fw-bold text-dark mb-0"},R={class:"mb-0 text-dark text-md mb-2"},L={class:"text-muted"},N={class:"col-md-9"},y={key:0},I=m((()=>(0,a.Lk)("div",{class:"d-flex flex-column justify-content-center align-items-center"},[(0,a.Lk)("div",{class:"spinner-border text-primary"}),(0,a.Lk)("p",{class:"mt-2"},"Loading messages. Please wait...")],-1))),b=[I],f={key:1},A={class:"card"},x={key:0},w={class:"d-flex p-4"},G={class:"me-3"},M=["src","alt"],V={class:"fw-bold text-dark mb-0"},X={class:"mb-0 text-dark"},F=m((()=>(0,a.Lk)("hr",{class:"my-0"},null,-1))),U={class:"pt-4"},W={key:0},j={key:0,class:"d-flex justify-content-start mb-3"},H={class:"message-container"},D={class:"message-time"},K={key:1,class:"d-flex justify-content-end mb-4"},P={class:"message-container-send"},z={class:"message-time-send"},Q={key:1},J={class:"d-flex flex-col justify-content-center align-items-center py-4"},q=m((()=>(0,a.Lk)("img",{src:"/img/no_data.svg",alt:"Chat Illustration",class:"mb-4",width:"250px"},null,-1))),B={class:"fw-medium"},Y=m((()=>(0,a.Lk)("hr",{class:"my-0"},null,-1))),Z={class:"p-3"},ee={class:"d-flex"},te=["disabled"],se={key:1},ae=m((()=>(0,a.Lk)("div",{class:"d-flex flex-col justify-content-center align-items-center py-4"},[(0,a.Lk)("img",{src:"/img/chat_illustration.svg",alt:"Chat Illustration",class:"mb-4",width:"250px"}),(0,a.Lk)("p",{class:"fw-medium"},"Click on a conversation to check messages.")],-1))),ce=[ae];var ne={__name:"ChatWithCustomers",setup(e){const t=(0,d.Pj)(),s=(0,c.KR)({message:"",conversation_id:""}),m=(0,c.KR)(!1);let k=(0,a.EW)({get:()=>t.state.chat.conversations,set:e=>t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e)}),I=(0,a.EW)({get:()=>t.state.chat.isFetchingCustomerConversations,set:e=>t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",e)}),ae=(0,a.EW)({get:()=>t.state.chat.isFetchingConversationMessages,set:e=>t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",e)}),ne=(0,a.EW)({get:()=>t.state.chat.selectedConversation,set:e=>t.commit("chat/SET_SELECTED_CONVERSATION",e)}),oe=(0,a.EW)({get:()=>t.state.chat.messages,set:e=>t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e)});(0,a.sV)((()=>{ie()}));const ie=()=>{t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!0),i.A.get(l.pe.GET_CUSTOMER_CONVERSATIONS).then((e=>{t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e.data.data),t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!1)})).catch((e=>{t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!1)}))},le=e=>{t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!0),i.A.post(l.pe.GET_CONVERSATION_MESSAGES,{conversation_id:e.conversation_id}).then((s=>{t.commit("chat/SET_SELECTED_CONVERSATION",e),t.commit("chat/STORE_CONVERSATION_MESSAGES",s.data.data),t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!1)})).catch((e=>{t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!1)}))},de=async()=>{try{m.value=!0;const e=t.state.chat.selectedConversation.conversation_id,a=new FormData;a.append("message",s.value.message),a.append("conversation_id",e);const c=await i.A.post(l.pe.SEND_MESSAGE_TO_CUSTOMER,a);$.growl.notice({message:c.data}),s.value.message="",await re(e)}catch(e){console.error("Error sending message:",e)}finally{m.value=!1}},re=async e=>{try{const s=await i.A.post(l.pe.GET_CONVERSATION_MESSAGES,{conversation_id:e});t.commit("chat/STORE_CONVERSATION_MESSAGES",s.data.data)}catch(s){console.error("Error fetching new messages:",s)}};return(e,t)=>((0,a.uX)(),(0,a.CE)("div",null,[E,(0,a.Lk)("div",_,[(0,a.Lk)("div",S,[(0,a.Lk)("div",v,[(0,c.R1)(I)?((0,a.uX)(),(0,a.CE)("div",u,C)):((0,a.uX)(),(0,a.CE)("div",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,c.R1)(k),((e,t)=>((0,a.uX)(),(0,a.CE)("a",{href:"#",onClick:t=>le(e),class:(0,n.C4)(["d-flex p-3 chat-box",{"border-bottom":(0,c.R1)(k).length>1}]),key:`conversation-${e.id}`},[(0,a.Lk)("div",T,[(0,a.Lk)("img",{src:e.conversation.data.customer_photo,class:"rounded-circle",style:{width:"60px"},alt:e.conversation.data.customer_name},null,8,g)]),(0,a.Lk)("div",null,[(0,a.Lk)("p",O,(0,n.v_)(e.conversation.data.customer_name),1),(0,a.Lk)("p",R,(0,n.v_)(e.conversation.last_message?(0,c.R1)(r.f7)(e.conversation.last_message.body):"Start Message"),1),(0,a.Lk)("small",L,(0,n.v_)(e.conversation.last_message?(0,c.R1)(r.kp)(e.conversation.last_message.updated_at):""),1)])],10,h)))),128))]))])]),(0,a.Lk)("div",N,[(0,c.R1)(ae)?((0,a.uX)(),(0,a.CE)("div",y,b)):((0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",A,[(0,c.R1)(ne)?((0,a.uX)(),(0,a.CE)("div",x,[(0,a.Lk)("div",w,[(0,a.Lk)("div",G,[(0,a.Lk)("img",{src:(0,c.R1)(ne).conversation.data.customer_photo,class:"rounded-circle",style:{width:"60px"},alt:(0,c.R1)(ne).conversation.data.customer_name},null,8,M)]),(0,a.Lk)("div",null,[(0,a.Lk)("p",V,(0,n.v_)((0,c.R1)(ne).conversation.data.customer_name),1),(0,a.Lk)("p",X,(0,n.v_)((0,c.R1)(ne).conversation.data.customer_email),1)])]),F,(0,a.Lk)("div",U,[(0,c.R1)(oe).length>0?((0,a.uX)(),(0,a.CE)("div",W,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,c.R1)(oe),(e=>((0,a.uX)(),(0,a.CE)("div",{class:"px-3",key:`chat-${(0,c.R1)(ne).id}-message-${e.id}`},[e.is_sender?e.is_sender?((0,a.uX)(),(0,a.CE)("div",K,[(0,a.Lk)("div",P,[(0,a.eW)((0,n.v_)(e.body)+" ",1),(0,a.Lk)("span",z,(0,n.v_)((0,c.R1)(r.kp)(e.created_at)),1)])])):(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",j,[(0,a.Lk)("div",H,[(0,a.eW)((0,n.v_)(e.body)+" ",1),(0,a.Lk)("span",D,(0,n.v_)((0,c.R1)(r.kp)(e.created_at)),1)])]))])))),128))])):((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.Lk)("div",J,[q,(0,a.Lk)("p",B,[(0,a.eW)("No messages present between you and "),(0,a.Lk)("b",null,(0,n.v_)((0,c.R1)(ne).conversation.data.customer_name),1),(0,a.eW)(".")])])]))]),Y,(0,a.Lk)("div",Z,[(0,a.Lk)("form",{onSubmit:(0,o.D$)(de,["prevent"])},[(0,a.Lk)("div",ee,[(0,a.bo)((0,a.Lk)("input",{class:"form-control me-3 border-0 border-bottom send-text-input rounded-0","onUpdate:modelValue":t[0]||(t[0]=e=>s.value.message=e),placeholder:"Start typing"},null,512),[[o.Jo,s.value.message]]),(0,a.Lk)("button",{class:"btn btn-primary",type:"submit",disabled:m.value},"Send",8,te)])],32)])])):((0,a.uX)(),(0,a.CE)("div",se,ce))])]))])])]))}},oe=s(1241);const ie=(0,oe.A)(ne,[["__scopeId","data-v-67899980"]]);var le=ie}}]);
//# sourceMappingURL=573.js.map