"use strict";(self["webpackChunkmyzola_admin"]=self["webpackChunkmyzola_admin"]||[]).push([[202],{1976:function(e,l,a){a.r(l),a.d(l,{default:function(){return Me}});a(4114);var n=a(6768),t=a(4232),i=a(144),s=a(5130),d=a(782),u=a(1387),o=a(6133),r=a(5015),c=a(7021),m=a(1114),v=a(7477),p=a(7676),k=a(4373),g=a(1219),f=a(4300),L=a(7190);const _=e=>((0,n.Qi)("data-v-1c209135"),e=e(),(0,n.jt)(),e),y={key:0,class:"row"},b={class:"p-1 m-r-10 d-flex align-items-center flex-wrap"},h={class:"col-md-12"},w={class:"w-100 listing_carousel_primary_media"},x=["src"],R={class:"primary_indicator"},F={class:"col-md-12 m-t-20"},C={class:"mz-color"},E={class:"col-md-12 d-flex align-items-center"},S={class:"listing_company_logo"},A=["src","alt"],W={class:"m-0"},N={class:"m-0"},I={class:"col-md-12 m-t-20"},K=_((()=>(0,n.Lk)("h6",null,"Description",-1))),X=["innerHTML"],O={class:"col-md-12 m-t-20"},M=_((()=>(0,n.Lk)("h6",null,"Payments",-1))),T={key:0,class:"col-md-12 d-flex flex-wrap align-items-center"},V=_((()=>(0,n.Lk)("strong",null,"Mode",-1))),P=_((()=>(0,n.Lk)("br",null,null,-1))),Q=_((()=>(0,n.Lk)("strong",null,"Amount",-1))),J=_((()=>(0,n.Lk)("br",null,null,-1))),H=_((()=>(0,n.Lk)("strong",null,"Reference",-1))),D=_((()=>(0,n.Lk)("br",null,null,-1))),U=_((()=>(0,n.Lk)("strong",null,"Added",-1))),G={key:1,class:"col-md-12"},j=_((()=>(0,n.Lk)("small",{class:"text-italic text-muted"},"No payments added",-1))),B=[j],z={class:"col-md-12 m-t-20"},q={class:"m-0"},Y={class:"col-md-12 m-b-20"},Z={class:"col-md-12 m-t-10 d-flex flex-wrap"},ee=["onClick"],le={class:"col-md-12 d-flex align-items-center"},ae=["src"],ne={class:"m-0"},te={class:"selected_indicator"},ie=_((()=>(0,n.Lk)("i",{class:"ri ri-check-line"},null,-1))),se=[ie],de={class:"row"},ue={class:"col-md-6"},oe={class:"col-md-6"},re=_((()=>(0,n.Lk)("br",null,null,-1))),ce={class:"col-md-12"},me={class:"col-md-12 m-b-20"},ve=_((()=>(0,n.Lk)("h6",null,"Upload additional listing media here",-1))),pe={class:"p-l-10"},ke=_((()=>(0,n.Lk)("small",null,"Primary Media",-1))),ge=_((()=>(0,n.Lk)("br",null,null,-1))),fe={key:0,class:"m-t-5"},Le={class:"d-flex"},_e={class:"p-1 uploaded-image"},ye=["src"],be=_((()=>(0,n.Lk)("i",{class:"ri ri-close-line"},null,-1))),he=[be],we=_((()=>(0,n.Lk)("small",{class:"text-danger text-italic"},"*Will replace previous primary media",-1))),xe={class:"p-l-10 m-t-10"},Re=_((()=>(0,n.Lk)("small",null,"Other Media",-1))),Fe=_((()=>(0,n.Lk)("br",null,null,-1))),Ce={class:"d-flex flex-wrap m-t-5"},Ee=["src"],Se=["onClick"],Ae=_((()=>(0,n.Lk)("i",{class:"ri ri-close-line"},null,-1))),We=[Ae],Ne=_((()=>(0,n.Lk)("br",null,null,-1))),Ie={class:"col-md-12"};var Ke={__name:"View",setup(e){const l=(0,d.Pj)(),_=(0,u.rd)(),j=((0,i.KR)(!1),(0,i.KR)(!1)),ie=(0,i.KR)({}),be=(0,i.KR)([]),Ae=(0,i.KR)([]),Ke=(0,i.KR)({mode:null,amount:null,reference:null}),Xe=(0,i.KR)(!1),Oe=(0,i.KR)(!1),Me=(0,i.KR)(null),Te=(0,i.KR)(null),Ve=(0,i.KR)([]),Pe=(0,i.KR)([]);function Qe(e){switch(e){case"add_payments":Xe.value=!0;break;case"add_media":Oe.value=!0;break;case"edit":Je();break;case"browse_reviews":ze();break}}function Je(){return l.commit("exploreHub/STORE_EDIT_LISTING",JSON.parse(JSON.stringify(ie.value))),_.replace({name:"explore_hub.listings.edit"})}function He(){k.A.get("/assets/PaymentModes.json").then((e=>Ae.value=e.data.map((e=>(e.image=a(1707)(`./${e.image}`),e)))))}function De(){if(!Ke.value.mode||!Ke.value.mode.length)return g.nk.warning("Please select a payment mode");if(!Ke.value.amount||!Ke.value.amount.toString().length)return g.nk.warning("Please enter the payment amount");if(isNaN(Ke.value.amount))return g.nk.warning("Please enter a valid amount");let e={id:ie.value.id,payments:[JSON.parse(JSON.stringify(Ke.value))]};j.value=!0,f.A.post(L.pe.EXPLORE_HUB_ADD_LISTING_PAYMENTS,e).then((e=>{$.growl.notice({message:e.data.message}),ie.value=e.data.data,Xe.value=!1,j.value=!1;let a=JSON.parse(JSON.stringify(l.state.exploreHub.activeListings)),n=a.findIndex((l=>l.id==e.data.data.id));n>-1&&(a[n]=e.data.data,l.commit("exploreHub/STORE_ACTIVE_LISTINGS",a))})).catch((e=>j.value=!1))}function Ue(e){const l=e.target.files[0],a=new FileReader;a.onload=e=>{Me.value=e.target.result,Te.value=l},a.readAsDataURL(l),$("#primaryListingMedia").val("")}function Ge(e){const l=e.target.files;for(let a=0;a<l.length;a++){const e=l[a],n=new FileReader;n.onload=l=>{Ve.value.push({name:e.name,url:l.target.result}),Pe.value.push(e)},n.readAsDataURL(e)}$("#listingMedia").val("")}function $e(){Me.value=null,Te.value=null}function je(e){Ve.value.splice(e,1),Pe.value.splice(e,1)}function Be(){if(!Te.value&&!Pe.value.length)return g.nk.warning("Please upload images to save");let e=new FormData;if(e.append("id",ie.value.id),Te.value&&e.append("primary_media",Te.value),Pe.value.length)for(let l=0;l<Pe.value.length;l++)e.append(`media[${l}]`,Pe.value[l]);j.value=!0,f.A.post(L.pe.EXPLORE_HUB_ADD_LISTING_MEDIA,e).then((e=>{$.growl.notice({message:e.data.message}),ie.value=e.data.data,Oe.value=!1,j.value=!1;let a=JSON.parse(JSON.stringify(l.state.exploreHub.activeListings)),n=a.findIndex((l=>l.id==e.data.data.id));n>-1&&(a[n]=e.data.data,l.commit("exploreHub/STORE_ACTIVE_LISTINGS",a))})).catch((e=>j.value=!1))}function ze(){return _.push({name:"explore_hub.listings.reviews",params:{listingTitleSlug:ie.value.title.toString().replaceAll(" ","-")}})}return(0,n.sV)((()=>{if(null==l.state.exploreHub.viewedListing)return _.back();ie.value=JSON.parse(JSON.stringify(l.state.exploreHub.viewedListing)),be.value=JSON.parse(JSON.stringify(ie.value.media)),He(),setTimeout((()=>{$(".listing_desc > p > span").css("background","inherit")}),500)})),(e,l)=>{const a=(0,n.g2)("el-button"),d=(0,n.g2)("el-divider"),u=(0,n.g2)("el-icon"),k=(0,n.g2)("el-dropdown-item"),g=(0,n.g2)("el-dropdown-menu"),f=(0,n.g2)("el-dropdown"),L=(0,n.g2)("el-input"),_=(0,n.g2)("el-dialog"),$=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)(n.FK,null,[Object.keys(ie.value).length?((0,n.uX)(),(0,n.CE)("div",y,[(0,n.Lk)("div",{class:(0,t.C4)(["col-sm-12 mb-3 d-inline-flex align-items-center",{"justify-content-end":!(0,i.R1)(c.Qv),"justify-content-between":(0,i.R1)(c.Qv)}])},[(0,n.Lk)("div",b,[(0,i.R1)(c.Qv)?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.bF)(a,{onClick:Je,type:"primary",icon:(0,i.R1)(v.ffu),text:"",bg:""},{default:(0,n.k6)((()=>[(0,n.eW)("Edit Listing")])),_:1},8,["icon"]),(0,n.bF)(d,{direction:"vertical"}),(0,n.bF)(a,{onClick:l[0]||(l[0]=e=>Xe.value=!0),type:"primary",icon:(0,i.R1)(v.v0_),text:"",bg:""},{default:(0,n.k6)((()=>[(0,n.eW)("Add Payment")])),_:1},8,["icon"]),(0,n.bF)(d,{direction:"vertical"}),(0,n.bF)(a,{onClick:l[1]||(l[1]=e=>Oe.value=!0),type:"primary",icon:(0,i.R1)(v.F46),text:"",bg:""},{default:(0,n.k6)((()=>[(0,n.eW)("Add Media")])),_:1},8,["icon"]),ie.value.has_reviews?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.bF)(d,{direction:"vertical"}),(0,n.bF)(a,{onClick:ze,type:"primary",icon:(0,i.R1)(v.MwB),text:"",bg:""},{default:(0,n.k6)((()=>[(0,n.eW)("Browse Listing Reviews")])),_:1},8,["icon"])],64)):(0,n.Q3)("",!0)],64)),(0,i.R1)(c.Qv)?((0,n.uX)(),(0,n.Wv)(f,{key:1,trigger:"click",onCommand:Qe},{dropdown:(0,n.k6)((()=>[(0,n.bF)(g,null,{default:(0,n.k6)((()=>[(0,n.bF)(k,{command:"edit",icon:(0,i.R1)(v.ffu)},{default:(0,n.k6)((()=>[(0,n.eW)("Edit Listing")])),_:1},8,["icon"]),(0,n.bF)(k,{command:"add_payments",icon:(0,i.R1)(v.v0_)},{default:(0,n.k6)((()=>[(0,n.eW)("Add Payment")])),_:1},8,["icon"]),(0,n.bF)(k,{command:"add_media",icon:(0,i.R1)(v.F46)},{default:(0,n.k6)((()=>[(0,n.eW)("Add Media")])),_:1},8,["icon"]),ie.value.has_reviews?((0,n.uX)(),(0,n.Wv)(k,{key:0,command:"browse_reviews",icon:(0,i.R1)(v.MwB)},{default:(0,n.k6)((()=>[(0,n.eW)("Browse Reviews")])),_:1},8,["icon"])):(0,n.Q3)("",!0)])),_:1})])),default:(0,n.k6)((()=>[(0,n.bF)(a,{plain:"",size:"large"},{default:(0,n.k6)((()=>[(0,n.eW)(" Listing Actions"),(0,n.bF)(u,{class:"el-icon--right"},{default:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(v.yd$))])),_:1})])),_:1})])),_:1})):(0,n.Q3)("",!0)]),(0,n.bF)(o.A)],2),(0,n.Lk)("div",h,[(0,n.bF)((0,i.R1)(m.FN),{itemsToShow:2,wrapAround:!0,transition:500,autoplay:2e3},{addons:(0,n.k6)((()=>[(0,n.bF)((0,i.R1)(m.Vx)),(0,n.bF)((0,i.R1)(m.dK))])),default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(ie.value.media,((e,l)=>((0,n.uX)(),(0,n.Wv)((0,i.R1)(m.q7),{key:"view-listing-media-"+e.id},{default:(0,n.k6)((()=>[(0,n.Lk)("div",w,[(0,n.Lk)("img",{src:e.path,class:"d-block w-100 carousel__item",style:{"max-height":"300px"}},null,8,x),(0,n.bo)((0,n.Lk)("div",R,"primary",512),[[s.aG,e.is_primary]])])])),_:2},1024)))),128))])),_:1})]),(0,n.Lk)("div",F,[(0,n.Lk)("h5",C,(0,t.v_)(ie.value.title),1)]),(0,n.Lk)("div",E,[(0,n.Lk)("div",S,[(0,n.Lk)("img",{src:ie.value.company.logo,alt:ie.value.company.name+"'s logo"},null,8,A)]),(0,n.Lk)("div",null,[(0,n.Lk)("h6",W,(0,t.v_)(ie.value.company.name),1),(0,n.Lk)("h6",N,[(0,n.Lk)("small",null,(0,t.v_)(ie.value.company.description),1)])])]),(0,n.Lk)("div",I,[K,(0,n.Lk)("div",{class:"alert alert-secondary alert-dismissible fade show listing_desc",role:"alert",innerHTML:ie.value.description},null,8,X)]),(0,n.Lk)("div",O,[M,ie.value.payments.length?((0,n.uX)(),(0,n.CE)("div",T,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(ie.value.payments,(e=>((0,n.uX)(),(0,n.CE)("div",{class:"p-1 view_listing_payment",key:"listing-payment-"+e.id},[(0,n.Lk)("small",null,[V,(0,n.eW)(": "+(0,t.v_)((0,i.R1)(r.A)(e.mode))+" ",1),P,Q,(0,n.eW)(": "+(0,t.v_)((0,i.R1)(c.RL)(e.amount,"KES")),1),J,H,(0,n.eW)(": "),(0,n.bo)((0,n.Lk)("template",null,[(0,n.eW)((0,t.v_)(e.reference),1)],512),[[s.aG,e.reference&&e.reference.length&&e.reference!=e.mode]]),D,U,(0,n.eW)(": "+(0,t.v_)(e.added_at),1)])])))),128))])):(0,n.Q3)("",!0),ie.value.payments.length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",G,B))]),(0,n.Lk)("div",z,[(0,n.Lk)("p",q,[(0,n.eW)((0,t.v_)(ie.value.start_date_desc)+" ",1),(0,n.Lk)("strong",null,(0,t.v_)(ie.value.start_at_formatted),1),(0,n.eW)("  -  "),(0,n.Lk)("strong",null,(0,t.v_)(ie.value.end_at_formatted),1)])])])):(0,n.Q3)("",!0),(0,n.bF)(_,{"custom-class":"el-dialog-width",width:"45%",fullscreen:(0,i.R1)(c.Qv),modelValue:Xe.value,"onUpdate:modelValue":l[4]||(l[4]=e=>Xe.value=e)},{default:(0,n.k6)((()=>[(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",Y,[(0,n.bF)(p.A,null,{default:(0,n.k6)((()=>[(0,n.eW)("Select Payment Mode")])),_:1}),(0,n.Lk)("div",Z,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Ae.value,(e=>((0,n.uX)(),(0,n.CE)("div",{class:(0,t.C4)(["p-1 payment-mode hov-pointer",{selected:e.name==Ke.value.mode}]),key:"all-payment-modes-"+e.name,onClick:l=>Ke.value.mode=e.name},[(0,n.Lk)("div",le,[(0,n.Lk)("img",{src:e.image,style:{"max-width":"40px","max-height":"20px"}},null,8,ae),(0,n.eW)("    "),(0,n.Lk)("h6",ne,(0,t.v_)((0,i.R1)(r.A)(e.name)),1)]),(0,n.bo)((0,n.Lk)("div",te,se,512),[[s.aG,Ke.value.mode==e.name]])],10,ee)))),128))])]),(0,n.Lk)("div",de,[(0,n.Lk)("div",ue,[(0,n.bF)(p.A,null,{default:(0,n.k6)((()=>[(0,n.eW)("Payment Amount")])),_:1}),(0,n.bF)(L,{placeholder:"Enter payment amount",modelValue:Ke.value.amount,"onUpdate:modelValue":l[2]||(l[2]=e=>Ke.value.amount=e)},null,8,["modelValue"])]),(0,n.Lk)("div",oe,[(0,n.bF)(p.A,null,{default:(0,n.k6)((()=>[(0,n.eW)("Transaction Reference")])),_:1}),(0,n.bF)(L,{placeholder:"Enter reference code",modelValue:Ke.value.reference,"onUpdate:modelValue":l[3]||(l[3]=e=>Ke.value.reference=e)},null,8,["modelValue"])])]),re,(0,n.Lk)("div",ce,[(0,n.bF)(a,{type:"primary",onClick:De},{default:(0,n.k6)((()=>[(0,n.eW)("Add Payment")])),_:1})])])),[[$,j.value]])])),_:1},8,["fullscreen","modelValue"]),(0,n.bF)(_,{"custom-class":"el-dialog-width",width:"45%",fullscreen:(0,i.R1)(c.Qv),modelValue:Oe.value,"onUpdate:modelValue":l[5]||(l[5]=e=>Oe.value=e)},{default:(0,n.k6)((()=>[(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",me,[ve,(0,n.Lk)("div",pe,[ke,ge,(0,n.Lk)("input",{style:{"max-width":"400px"},type:"file",class:"form-control",id:"primaryListingMedia",onChange:Ue},null,32),null!=Me.value?((0,n.uX)(),(0,n.CE)("div",fe,[(0,n.Lk)("div",Le,[(0,n.Lk)("div",_e,[(0,n.Lk)("img",{src:Me.value,style:{"max-width":"80px","max-height":"60px"}},null,8,ye),(0,n.Lk)("div",{class:"remover",onClick:$e},he)])]),we])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",xe,[Re,Fe,(0,n.Lk)("input",{style:{"max-width":"400px"},type:"file",multiple:"",class:"form-control",id:"listingMedia",onChange:Ge},null,32),(0,n.Lk)("div",Ce,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Ve.value,((e,l)=>((0,n.uX)(),(0,n.CE)("div",{class:"p-1 uploaded-image",key:"uploaded-media-"+l},[(0,n.Lk)("img",{src:e.url,style:{"max-width":"80px","max-height":"60px"}},null,8,Ee),(0,n.Lk)("div",{class:"remover",onClick:e=>je(l)},We,8,Se)])))),128))])])]),Ne,(0,n.Lk)("div",Ie,[(0,n.bF)(a,{type:"primary",onClick:Be},{default:(0,n.k6)((()=>[(0,n.eW)("Save Media")])),_:1})])])),[[$,j.value]])])),_:1},8,["fullscreen","modelValue"])],64)}}},Xe=a(1241);const Oe=(0,Xe.A)(Ke,[["__scopeId","data-v-1c209135"]]);var Me=Oe}}]);
//# sourceMappingURL=202.js.map