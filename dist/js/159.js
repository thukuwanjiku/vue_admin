(self["webpackChunkmyzola_admin"]=self["webpackChunkmyzola_admin"]||[]).push([[159],{4594:function(e,t,n){n(4114),n(6573),n(8100),n(7936),n(7467),n(4732),n(9577),n(4979),
/*!
 * Pusher JavaScript Library v8.4.0-rc2
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */
function(t,n){e.exports=n()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=256,r=function(){function e(e){void 0===e&&(e="="),this._paddingCharacter=e}return e.prototype.encodedLength=function(e){return this._paddingCharacter?(e+2)/3*4|0:(8*e+5)/6|0},e.prototype.encode=function(e){for(var t="",n=0;n<e.length-2;n+=3){var i=e[n]<<16|e[n+1]<<8|e[n+2];t+=this._encodeByte(i>>>18&63),t+=this._encodeByte(i>>>12&63),t+=this._encodeByte(i>>>6&63),t+=this._encodeByte(i>>>0&63)}var s=e.length-n;if(s>0){i=e[n]<<16|(2===s?e[n+1]<<8:0);t+=this._encodeByte(i>>>18&63),t+=this._encodeByte(i>>>12&63),t+=2===s?this._encodeByte(i>>>6&63):this._paddingCharacter||"",t+=this._paddingCharacter||""}return t},e.prototype.maxDecodedLength=function(e){return this._paddingCharacter?e/4*3|0:(6*e+7)/8|0},e.prototype.decodedLength=function(e){return this.maxDecodedLength(e.length-this._getPaddingLength(e))},e.prototype.decode=function(e){if(0===e.length)return new Uint8Array(0);for(var t=this._getPaddingLength(e),n=e.length-t,i=new Uint8Array(this.maxDecodedLength(n)),r=0,o=0,a=0,c=0,u=0,h=0,l=0;o<n-4;o+=4)c=this._decodeChar(e.charCodeAt(o+0)),u=this._decodeChar(e.charCodeAt(o+1)),h=this._decodeChar(e.charCodeAt(o+2)),l=this._decodeChar(e.charCodeAt(o+3)),i[r++]=c<<2|u>>>4,i[r++]=u<<4|h>>>2,i[r++]=h<<6|l,a|=c&s,a|=u&s,a|=h&s,a|=l&s;if(o<n-1&&(c=this._decodeChar(e.charCodeAt(o)),u=this._decodeChar(e.charCodeAt(o+1)),i[r++]=c<<2|u>>>4,a|=c&s,a|=u&s),o<n-2&&(h=this._decodeChar(e.charCodeAt(o+2)),i[r++]=u<<4|h>>>2,a|=h&s),o<n-3&&(l=this._decodeChar(e.charCodeAt(o+3)),i[r++]=h<<6|l,a|=l&s),0!==a)throw new Error("Base64Coder: incorrect characters for decoding");return i},e.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-15,t+=62-e>>>8&3,String.fromCharCode(t)},e.prototype._decodeChar=function(e){var t=s;return t+=(42-e&e-44)>>>8&-s+e-43+62,t+=(46-e&e-48)>>>8&-s+e-47+63,t+=(47-e&e-58)>>>8&-s+e-48+52,t+=(64-e&e-91)>>>8&-s+e-65+0,t+=(96-e&e-123)>>>8&-s+e-97+26,t},e.prototype._getPaddingLength=function(e){var t=0;if(this._paddingCharacter){for(var n=e.length-1;n>=0;n--){if(e[n]!==this._paddingCharacter)break;t++}if(e.length<4||t>2)throw new Error("Base64Coder: incorrect padding")}return t},e}();t.Coder=r;var o=new r;function a(e){return o.encode(e)}function c(e){return o.decode(e)}t.encode=a,t.decode=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._encodeByte=function(e){var t=e;return t+=65,t+=25-e>>>8&6,t+=51-e>>>8&-75,t+=61-e>>>8&-13,t+=62-e>>>8&49,String.fromCharCode(t)},t.prototype._decodeChar=function(e){var t=s;return t+=(44-e&e-46)>>>8&-s+e-45+62,t+=(94-e&e-96)>>>8&-s+e-95+63,t+=(47-e&e-58)>>>8&-s+e-48+52,t+=(64-e&e-91)>>>8&-s+e-65+0,t+=(96-e&e-123)>>>8&-s+e-97+26,t},t}(r);t.URLSafeCoder=u;var h=new u;function l(e){return h.encode(e)}function d(e){return h.decode(e)}t.encodeURLSafe=l,t.decodeURLSafe=d,t.encodedLength=function(e){return o.encodedLength(e)},t.maxDecodedLength=function(e){return o.maxDecodedLength(e)},t.decodedLength=function(e){return o.decodedLength(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="utf8: invalid string",s="utf8: invalid source encoding";function r(e){for(var t=new Uint8Array(o(e)),n=0,i=0;i<e.length;i++){var s=e.charCodeAt(i);s<128?t[n++]=s:s<2048?(t[n++]=192|s>>6,t[n++]=128|63&s):s<55296?(t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s):(i++,s=(1023&s)<<10,s|=1023&e.charCodeAt(i),s+=65536,t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s)}return t}function o(e){for(var t=0,n=0;n<e.length;n++){var s=e.charCodeAt(n);if(s<128)t+=1;else if(s<2048)t+=2;else if(s<55296)t+=3;else{if(!(s<=57343))throw new Error(i);if(n>=e.length-1)throw new Error(i);n++,t+=4}}return t}function a(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];if(128&i){var r=void 0;if(i<224){if(n>=e.length)throw new Error(s);var o=e[++n];if(128!==(192&o))throw new Error(s);i=(31&i)<<6|63&o,r=128}else if(i<240){if(n>=e.length-1)throw new Error(s);o=e[++n];var a=e[++n];if(128!==(192&o)||128!==(192&a))throw new Error(s);i=(15&i)<<12|(63&o)<<6|63&a,r=2048}else{if(!(i<248))throw new Error(s);if(n>=e.length-2)throw new Error(s);o=e[++n],a=e[++n];var c=e[++n];if(128!==(192&o)||128!==(192&a)||128!==(192&c))throw new Error(s);i=(15&i)<<18|(63&o)<<12|(63&a)<<6|63&c,r=65536}if(i<r||i>=55296&&i<=57343)throw new Error(s);if(i>=65536){if(i>1114111)throw new Error(s);i-=65536,t.push(String.fromCharCode(55296|i>>10)),i=56320|1023&i}}t.push(String.fromCharCode(i))}return t.join("")}t.encode=r,t.encodedLength=o,t.decode=a},function(e,t,n){e.exports=n(3).default},function(e,t,n){"use strict";n.r(t);class i{constructor(e,t){this.lastId=0,this.prefix=e,this.name=t}create(e){this.lastId++;var t=this.lastId,n=this.prefix+t,i=this.name+"["+t+"]",s=!1,r=function(){s||(e.apply(null,arguments),s=!0)};return this[t]=r,{number:t,id:n,name:i,callback:r}}remove(e){delete this[e.number]}}var s=new i("_pusher_script_","Pusher.ScriptReceivers"),r={VERSION:"8.4.0-rc2",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},o=r;class a{constructor(e){this.options=e,this.receivers=e.receivers||s,this.loading={}}load(e,t,n){var i=this;if(i.loading[e]&&i.loading[e].length>0)i.loading[e].push(n);else{i.loading[e]=[n];var s=Kt.createScriptRequest(i.getPath(e,t)),r=i.receivers.create((function(t){if(i.receivers.remove(r),i.loading[e]){var n=i.loading[e];delete i.loading[e];for(var o=function(e){e||s.cleanup()},a=0;a<n.length;a++)n[a](t,o)}}));s.send(r)}}getRoot(e){var t,n=Kt.getDocument().location.protocol;return t=e&&e.useTLS||"https:"===n?this.options.cdn_https:this.options.cdn_http,t.replace(/\/*$/,"")+"/"+this.options.version}getPath(e,t){return this.getRoot(t)+"/"+e+this.options.suffix+".js"}}var c=new i("_pusher_dependencies","Pusher.DependenciesReceivers"),u=new a({cdn_http:o.cdn_http,cdn_https:o.cdn_https,version:o.VERSION,suffix:o.dependency_suffix,receivers:c});const h={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}},l=function(e){const t="See:",n=h.urls[e];if(!n)return"";let i;return n.fullUrl?i=n.fullUrl:n.path&&(i=h.baseUrl+n.path),i?`${t} ${i}`:""};var d,p={buildLogSuffix:l};(function(e){e["UserAuthentication"]="user-authentication",e["ChannelAuthorization"]="channel-authorization"})(d||(d={}));class f extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class v extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class g extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class m extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class b extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class y extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class k extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class w extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class S extends Error{constructor(e,t){super(t),this.status=e,Object.setPrototypeOf(this,new.target.prototype)}}const _=function(e,t,n,i,s){const r=Kt.createXHR();for(var o in r.open("POST",n.endpoint,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.headers)r.setRequestHeader(o,n.headers[o]);if(null!=n.headersProvider){let e=n.headersProvider();for(var o in e)r.setRequestHeader(o,e[o])}return r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){let t,n=!1;try{t=JSON.parse(r.responseText),n=!0}catch(e){s(new S(200,`JSON returned from ${i.toString()} endpoint was invalid, yet status code was 200. Data was: ${r.responseText}`),null)}n&&s(null,t)}else{let e="";switch(i){case d.UserAuthentication:e=p.buildLogSuffix("authenticationEndpoint");break;case d.ChannelAuthorization:e=`Clients must be authorized to join private or presence channels. ${p.buildLogSuffix("authorizationEndpoint")}`;break}s(new S(r.status,`Unable to retrieve auth string from ${i.toString()} endpoint - received status: ${r.status} from ${n.endpoint}. ${e}`),null)}},r.send(t),r};var C=_;function T(e){return N(I(e))}for(var E=String.fromCharCode,O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P={},L=0,x=O.length;L<x;L++)P[O.charAt(L)]=L;var R=function(e){var t=e.charCodeAt(0);return t<128?e:t<2048?E(192|t>>>6)+E(128|63&t):E(224|t>>>12&15)+E(128|t>>>6&63)+E(128|63&t)},I=function(e){return e.replace(/[^\x00-\x7F]/g,R)},A=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),i=[O.charAt(n>>>18),O.charAt(n>>>12&63),t>=2?"=":O.charAt(n>>>6&63),t>=1?"=":O.charAt(63&n)];return i.join("")},N=window.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,A)};class j{constructor(e,t,n,i){this.clear=t,this.timer=e((()=>{this.timer&&(this.timer=i(this.timer))}),n)}isRunning(){return null!==this.timer}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var D=j;function M(e){window.clearTimeout(e)}function U(e){window.clearInterval(e)}class H extends D{constructor(e,t){super(setTimeout,M,e,(function(e){return t(),null}))}}class q extends D{constructor(e,t){super(setInterval,U,e,(function(e){return t(),e}))}}var z={now(){return Date.now?Date.now():(new Date).valueOf()},defer(e){return new H(0,e)},method(e,...t){var n=Array.prototype.slice.call(arguments,1);return function(t){return t[e].apply(t,n.concat(arguments))}}},X=z;function F(e,...t){for(var n=0;n<t.length;n++){var i=t[n];for(var s in i)i[s]&&i[s].constructor&&i[s].constructor===Object?e[s]=F(e[s]||{},i[s]):e[s]=i[s]}return e}function B(){for(var e=["Pusher"],t=0;t<arguments.length;t++)"string"===typeof arguments[t]?e.push(arguments[t]):e.push(oe(arguments[t]));return e.join(" : ")}function $(e,t){var n=Array.prototype.indexOf;if(null===e)return-1;if(n&&e.indexOf===n)return e.indexOf(t);for(var i=0,s=e.length;i<s;i++)if(e[i]===t)return i;return-1}function V(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(e[n],n,e)}function G(e){var t=[];return V(e,(function(e,n){t.push(n)})),t}function W(e){var t=[];return V(e,(function(e){t.push(e)})),t}function J(e,t,n){for(var i=0;i<e.length;i++)t.call(n||window,e[i],i,e)}function Q(e,t){for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i,e,n));return n}function K(e,t){var n={};return V(e,(function(e,i){n[i]=t(e)})),n}function Y(e,t){t=t||function(e){return!!e};for(var n=[],i=0;i<e.length;i++)t(e[i],i,e,n)&&n.push(e[i]);return n}function Z(e,t){var n={};return V(e,(function(i,s){(t&&t(i,s,e,n)||Boolean(i))&&(n[s]=i)})),n}function ee(e){var t=[];return V(e,(function(e,n){t.push([n,e])})),t}function te(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1}function ne(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0}function ie(e){return K(e,(function(e){return"object"===typeof e&&(e=oe(e)),encodeURIComponent(T(e.toString()))}))}function se(e){var t=Z(e,(function(e){return void 0!==e})),n=Q(ee(ie(t)),X.method("join","=")).join("&");return n}function re(e){var t=[],n=[];return function e(i,s){var r,o,a;switch(typeof i){case"object":if(!i)return null;for(r=0;r<t.length;r+=1)if(t[r]===i)return{$ref:n[r]};if(t.push(i),n.push(s),"[object Array]"===Object.prototype.toString.apply(i))for(a=[],r=0;r<i.length;r+=1)a[r]=e(i[r],s+"["+r+"]");else for(o in a={},i)Object.prototype.hasOwnProperty.call(i,o)&&(a[o]=e(i[o],s+"["+JSON.stringify(o)+"]"));return a;case"number":case"string":case"boolean":return i}}(e,"$")}function oe(e){try{return JSON.stringify(e)}catch(t){return JSON.stringify(re(e))}}class ae{constructor(){this.globalLog=e=>{window.console&&window.console.log&&window.console.log(e)}}debug(...e){this.log(this.globalLog,e)}warn(...e){this.log(this.globalLogWarn,e)}error(...e){this.log(this.globalLogError,e)}globalLogWarn(e){window.console&&window.console.warn?window.console.warn(e):this.globalLog(e)}globalLogError(e){window.console&&window.console.error?window.console.error(e):this.globalLogWarn(e)}log(e,...t){var n=B.apply(this,arguments);if(Ln.log)Ln.log(n);else if(Ln.logToConsole){const t=e.bind(this);t(n)}}}var ce=new ae,ue=function(e,t,n,i,s){void 0===n.headers&&null==n.headersProvider||ce.warn(`To send headers with the ${i.toString()} request, you must use AJAX, rather than JSONP.`);var r=e.nextAuthCallbackID.toString();e.nextAuthCallbackID++;var o=e.getDocument(),a=o.createElement("script");e.auth_callbacks[r]=function(e){s(null,e)};var c="Pusher.auth_callbacks['"+r+"']";a.src=n.endpoint+"?callback="+encodeURIComponent(c)+"&"+t;var u=o.getElementsByTagName("head")[0]||o.documentElement;u.insertBefore(a,u.firstChild)},he=ue;class le{constructor(e){this.src=e}send(e){var t=this,n="Error loading "+t.src;t.script=document.createElement("script"),t.script.id=e.id,t.script.src=t.src,t.script.type="text/javascript",t.script.charset="UTF-8",t.script.addEventListener?(t.script.onerror=function(){e.callback(n)},t.script.onload=function(){e.callback(null)}):t.script.onreadystatechange=function(){"loaded"!==t.script.readyState&&"complete"!==t.script.readyState||e.callback(null)},void 0===t.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(t.errorScript=document.createElement("script"),t.errorScript.id=e.id+"_error",t.errorScript.text=e.name+"('"+n+"');",t.script.async=t.errorScript.async=!1):t.script.async=!0;var i=document.getElementsByTagName("head")[0];i.insertBefore(t.script,i.firstChild),t.errorScript&&i.insertBefore(t.errorScript,t.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class de{constructor(e,t){this.url=e,this.data=t}send(e){if(!this.request){var t=se(this.data),n=this.url+"/"+e.number+"?"+t;this.request=Kt.createScriptRequest(n),this.request.send(e)}}cleanup(){this.request&&this.request.cleanup()}}var pe=function(e,t){return function(n,i){var r="http"+(t?"s":"")+"://",o=r+(e.host||e.options.host)+e.options.path,a=Kt.createJSONPRequest(o,n),c=Kt.ScriptReceivers.create((function(t,n){s.remove(c),a.cleanup(),n&&n.host&&(e.host=n.host),i&&i(t,n)}));a.send(c)}},fe={name:"jsonp",getAgent:pe},ve=fe;function ge(e,t,n){var i=e+(t.useTLS?"s":""),s=t.useTLS?t.hostTLS:t.hostNonTLS;return i+"://"+s+n}function me(e,t){var n="/app/"+e,i="?protocol="+o.PROTOCOL+"&client=js&version="+o.VERSION+(t?"&"+t:"");return n+i}var be={getInitial:function(e,t){var n=(t.httpPath||"")+me(e,"flash=false");return ge("ws",t,n)}},ye={getInitial:function(e,t){var n=(t.httpPath||"/pusher")+me(e);return ge("http",t,n)}},ke={getInitial:function(e,t){return ge("http",t,t.httpPath||"/pusher")},getPath:function(e,t){return me(e)}};class we{constructor(){this._callbacks={}}get(e){return this._callbacks[Se(e)]}add(e,t,n){var i=Se(e);this._callbacks[i]=this._callbacks[i]||[],this._callbacks[i].push({fn:t,context:n})}remove(e,t,n){if(e||t||n){var i=e?[Se(e)]:G(this._callbacks);t||n?this.removeCallback(i,t,n):this.removeAllCallbacks(i)}else this._callbacks={}}removeCallback(e,t,n){J(e,(function(e){this._callbacks[e]=Y(this._callbacks[e]||[],(function(e){return t&&t!==e.fn||n&&n!==e.context})),0===this._callbacks[e].length&&delete this._callbacks[e]}),this)}removeAllCallbacks(e){J(e,(function(e){delete this._callbacks[e]}),this)}}function Se(e){return"_"+e}class _e{constructor(e){this.callbacks=new we,this.global_callbacks=[],this.failThrough=e}bind(e,t,n){return this.callbacks.add(e,t,n),this}bind_global(e){return this.global_callbacks.push(e),this}unbind(e,t,n){return this.callbacks.remove(e,t,n),this}unbind_global(e){return e?(this.global_callbacks=Y(this.global_callbacks||[],(t=>t!==e)),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(e,t,n){for(var i=0;i<this.global_callbacks.length;i++)this.global_callbacks[i](e,t);var s=this.callbacks.get(e),r=[];if(n?r.push(t,n):t&&r.push(t),s&&s.length>0)for(i=0;i<s.length;i++)s[i].fn.apply(s[i].context||window,r);else this.failThrough&&this.failThrough(e,t);return this}}class Ce extends _e{constructor(e,t,n,i,s){super(),this.initialize=Kt.transportConnectionInitializer,this.hooks=e,this.name=t,this.priority=n,this.key=i,this.options=s,this.state="new",this.timeline=s.timeline,this.activityTimeout=s.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return Boolean(this.hooks.handlesActivityChecks)}supportsPing(){return Boolean(this.hooks.supportsPing)}connect(){if(this.socket||"initialized"!==this.state)return!1;var e=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(e,this.options)}catch(t){return X.defer((()=>{this.onError(t),this.changeState("closed")})),!1}return this.bindListeners(),ce.debug("Connecting",{transport:this.name,url:e}),this.changeState("connecting"),!0}close(){return!!this.socket&&(this.socket.close(),!0)}send(e){return"open"===this.state&&(X.defer((()=>{this.socket&&this.socket.send(e)})),!0)}ping(){"open"===this.state&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(e){this.emit("error",{type:"WebSocketError",error:e}),this.timeline.error(this.buildTimelineMessage({error:e.toString()}))}onClose(e){e?this.changeState("closed",{code:e.code,reason:e.reason,wasClean:e.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(e){this.emit("message",e)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=e=>{this.onError(e)},this.socket.onclose=e=>{this.onClose(e)},this.socket.onmessage=e=>{this.onMessage(e)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(e,t){this.state=e,this.timeline.info(this.buildTimelineMessage({state:e,params:t})),this.emit(e,t)}buildTimelineMessage(e){return F({cid:this.id},e)}}class Te{constructor(e){this.hooks=e}isSupported(e){return this.hooks.isSupported(e)}createConnection(e,t,n,i){return new Ce(this.hooks,e,t,n,i)}}var Ee=new Te({urls:be,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(Kt.getWebSocketAPI())},isSupported:function(){return Boolean(Kt.getWebSocketAPI())},getSocket:function(e){return Kt.createWebSocket(e)}}),Oe={urls:ye,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},Pe=F({getSocket:function(e){return Kt.HTTPFactory.createStreamingSocket(e)}},Oe),Le=F({getSocket:function(e){return Kt.HTTPFactory.createPollingSocket(e)}},Oe),xe={isSupported:function(){return Kt.isXHRSupported()}},Re=new Te(F({},Pe,xe)),Ie=new Te(F({},Le,xe)),Ae={ws:Ee,xhr_streaming:Re,xhr_polling:Ie},Ne=Ae,je=new Te({file:"sockjs",urls:ke,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(e,t){return new window.SockJS(e,null,{js_path:u.getPath("sockjs",{useTLS:t.useTLS}),ignore_null_origin:t.ignoreNullOrigin})},beforeOpen:function(e,t){e.send(JSON.stringify({path:t}))}}),De={isSupported:function(e){var t=Kt.isXDRSupported(e.useTLS);return t}},Me=new Te(F({},Pe,De)),Ue=new Te(F({},Le,De));Ne.xdr_streaming=Me,Ne.xdr_polling=Ue,Ne.sockjs=je;var He=Ne;class qe extends _e{constructor(){super();var e=this;void 0!==window.addEventListener&&(window.addEventListener("online",(function(){e.emit("online")}),!1),window.addEventListener("offline",(function(){e.emit("offline")}),!1))}isOnline(){return void 0===window.navigator.onLine||window.navigator.onLine}}var ze=new qe;class Xe{constructor(e,t,n){this.manager=e,this.transport=t,this.minPingDelay=n.minPingDelay,this.maxPingDelay=n.maxPingDelay,this.pingDelay=void 0}createConnection(e,t,n,i){i=F({},i,{activityTimeout:this.pingDelay});var s=this.transport.createConnection(e,t,n,i),r=null,o=function(){s.unbind("open",o),s.bind("closed",a),r=X.now()},a=e=>{if(s.unbind("closed",a),1002===e.code||1003===e.code)this.manager.reportDeath();else if(!e.wasClean&&r){var t=X.now()-r;t<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(t/2,this.minPingDelay))}};return s.bind("open",o),s}isSupported(e){return this.manager.isAlive()&&this.transport.isSupported(e)}}const Fe={decodeMessage:function(e){try{var t=JSON.parse(e.data),n=t.data;if("string"===typeof n)try{n=JSON.parse(t.data)}catch(s){}var i={event:t.event,channel:t.channel,data:n};return t.user_id&&(i.user_id=t.user_id),i}catch(s){throw{type:"MessageParseError",error:s,data:e.data}}},encodeMessage:function(e){return JSON.stringify(e)},processHandshake:function(e){var t=Fe.decodeMessage(e);if("pusher:connection_established"===t.event){if(!t.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:t.data.socket_id,activityTimeout:1e3*t.data.activity_timeout}}if("pusher:error"===t.event)return{action:this.getCloseAction(t.data),error:this.getCloseError(t.data)};throw"Invalid handshake"},getCloseAction:function(e){return e.code<4e3?e.code>=1002&&e.code<=1004?"backoff":null:4e3===e.code?"tls_only":e.code<4100?"refused":e.code<4200?"backoff":e.code<4300?"retry":"refused"},getCloseError:function(e){return 1e3!==e.code&&1001!==e.code?{type:"PusherError",data:{code:e.code,message:e.reason||e.message}}:null}};var Be=Fe;class $e extends _e{constructor(e,t){super(),this.id=e,this.transport=t,this.activityTimeout=t.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(e){return this.transport.send(e)}send_event(e,t,n){var i={event:e,data:t};return n&&(i.channel=n),ce.debug("Event sent",i),this.send(Be.encodeMessage(i))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var e={message:e=>{var t;try{t=Be.decodeMessage(e)}catch(n){this.emit("error",{type:"MessageParseError",error:n,data:e.data})}if(void 0!==t){switch(ce.debug("Event recd",t),t.event){case"pusher:error":this.emit("error",{type:"PusherError",data:t.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",t)}},activity:()=>{this.emit("activity")},error:e=>{this.emit("error",e)},closed:e=>{t(),e&&e.code&&this.handleCloseEvent(e),this.transport=null,this.emit("closed")}},t=()=>{V(e,((e,t)=>{this.transport.unbind(t,e)}))};V(e,((e,t)=>{this.transport.bind(t,e)}))}handleCloseEvent(e){var t=Be.getCloseAction(e),n=Be.getCloseError(e);n&&this.emit("error",n),t&&this.emit(t,{action:t,error:n})}}class Ve{constructor(e,t){this.transport=e,this.callback=t,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=e=>{var t;this.unbindListeners();try{t=Be.processHandshake(e)}catch(n){return this.finish("error",{error:n}),void this.transport.close()}"connected"===t.action?this.finish("connected",{connection:new $e(t.id,this.transport),activityTimeout:t.activityTimeout}):(this.finish(t.action,{error:t.error}),this.transport.close())},this.onClosed=e=>{this.unbindListeners();var t=Be.getCloseAction(e)||"backoff",n=Be.getCloseError(e);this.finish(t,{error:n})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(e,t){this.callback(F({transport:this.transport,action:e},t))}}class Ge{constructor(e,t){this.timeline=e,this.options=t||{}}send(e,t){this.timeline.isEmpty()||this.timeline.send(Kt.TimelineTransport.getAgent(this,e),t)}}class We extends _e{constructor(e,t){super((function(t,n){ce.debug("No callbacks on "+e+" for "+t)})),this.name=e,this.pusher=t,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(e,t){return t(null,{auth:""})}trigger(e,t){if(0!==e.indexOf("client-"))throw new f("Event '"+e+"' does not start with 'client-'");if(!this.subscribed){var n=p.buildLogSuffix("triggeringClientEvents");ce.warn(`Client event triggered before channel 'subscription_succeeded' event . ${n}`)}return this.pusher.send_event(e,t,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(e){var t=e.event,n=e.data;if("pusher_internal:subscription_succeeded"===t)this.handleSubscriptionSucceededEvent(e);else if("pusher_internal:subscription_count"===t)this.handleSubscriptionCountEvent(e);else if(0!==t.indexOf("pusher_internal:")){var i={};this.emit(t,n,i)}}handleSubscriptionSucceededEvent(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",e.data)}handleSubscriptionCountEvent(e){e.data.subscription_count&&(this.subscriptionCount=e.data.subscription_count),this.emit("pusher:subscription_count",e.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,((e,t)=>{e?(this.subscriptionPending=!1,ce.error(e.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:e.message},e instanceof S?{status:e.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:t.auth,channel_data:t.channel_data,channel:this.name})})))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class Je extends We{authorize(e,t){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:e},t)}}class Qe{constructor(){this.reset()}get(e){return Object.prototype.hasOwnProperty.call(this.members,e)?{id:e,info:this.members[e]}:null}each(e){V(this.members,((t,n)=>{e(this.get(n))}))}setMyID(e){this.myID=e}onSubscription(e){this.members=e.presence.hash,this.count=e.presence.count,this.me=this.get(this.myID)}addMember(e){return null===this.get(e.user_id)&&this.count++,this.members[e.user_id]=e.user_info,this.get(e.user_id)}removeMember(e){var t=this.get(e.user_id);return t&&(delete this.members[e.user_id],this.count--),t}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var Ke=function(e,t,n,i){function s(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function o(e){try{c(i.next(e))}catch(t){r(t)}}function a(e){try{c(i["throw"](e))}catch(t){r(t)}}function c(e){e.done?n(e.value):s(e.value).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class Ye extends Je{constructor(e,t){super(e,t),this.members=new Qe}authorize(e,t){super.authorize(e,((e,n)=>Ke(this,void 0,void 0,(function*(){if(!e)if(null!=n.channel_data){var i=JSON.parse(n.channel_data);this.members.setMyID(i.user_id)}else{if(yield this.pusher.user.signinDonePromise,null==this.pusher.user.user_data){let e=p.buildLogSuffix("authorizationEndpoint");return ce.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${e}, or the user should be signed in.`),void t("Invalid auth response")}this.members.setMyID(this.pusher.user.user_data.id)}t(e,n)}))))}handleEvent(e){var t=e.event;if(0===t.indexOf("pusher_internal:"))this.handleInternalEvent(e);else{var n=e.data,i={};e.user_id&&(i.user_id=e.user_id),this.emit(t,n,i)}}handleInternalEvent(e){var t=e.event,n=e.data;switch(t){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(e);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(e);break;case"pusher_internal:member_added":var i=this.members.addMember(n);this.emit("pusher:member_added",i);break;case"pusher_internal:member_removed":var s=this.members.removeMember(n);s&&this.emit("pusher:member_removed",s);break}}handleSubscriptionSucceededEvent(e){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(e.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var Ze=n(1),et=n(0);class tt extends Je{constructor(e,t,n){super(e,t),this.key=null,this.nacl=n}authorize(e,t){super.authorize(e,((e,n)=>{if(e)return void t(e,n);let i=n["shared_secret"];i?(this.key=Object(et["decode"])(i),delete n["shared_secret"],t(null,n)):t(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null)}))}trigger(e,t){throw new y("Client events are not currently supported for encrypted channels")}handleEvent(e){var t=e.event,n=e.data;0!==t.indexOf("pusher_internal:")&&0!==t.indexOf("pusher:")?this.handleEncryptedEvent(t,n):super.handleEvent(e)}handleEncryptedEvent(e,t){if(!this.key)return void ce.debug("Received encrypted event before key has been retrieved from the authEndpoint");if(!t.ciphertext||!t.nonce)return void ce.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+t);let n=Object(et["decode"])(t.ciphertext);if(n.length<this.nacl.secretbox.overheadLength)return void ce.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${n.length}`);let i=Object(et["decode"])(t.nonce);if(i.length<this.nacl.secretbox.nonceLength)return void ce.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${i.length}`);let s=this.nacl.secretbox.open(n,i,this.key);if(null===s)return ce.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),void this.authorize(this.pusher.connection.socket_id,((t,r)=>{t?ce.error(`Failed to make a request to the authEndpoint: ${r}. Unable to fetch new key, so dropping encrypted event`):(s=this.nacl.secretbox.open(n,i,this.key),null!==s?this.emit(e,this.getDataToEmit(s)):ce.error("Failed to decrypt event with new key. Dropping encrypted event"))}));this.emit(e,this.getDataToEmit(s))}getDataToEmit(e){let t=Object(Ze["decode"])(e);try{return JSON.parse(t)}catch(n){return t}}}class nt extends _e{constructor(e,t){super(),this.state="initialized",this.connection=null,this.key=e,this.options=t,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var n=Kt.getNetwork();n.bind("online",(()=>{this.timeline.info({netinfo:"online"}),"connecting"!==this.state&&"unavailable"!==this.state||this.retryIn(0)})),n.bind("offline",(()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()})),this.updateStrategy()}switchCluster(e){this.key=e,this.updateStrategy(),this.retryIn(0)}connect(){this.connection||this.runner||(this.strategy.isSupported()?(this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()):this.updateState("failed"))}send(e){return!!this.connection&&this.connection.send(e)}send_event(e,t,n){return!!this.connection&&this.connection.send_event(e,t,n)}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var e=(t,n)=>{t?this.runner=this.strategy.connect(0,e):"error"===n.action?(this.emit("error",{type:"HandshakeError",error:n.error}),this.timeline.error({handshakeError:n.error})):(this.abortConnecting(),this.handshakeCallbacks[n.action](n))};this.runner=this.strategy.connect(0,e)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var e=this.abandonConnection();e.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(e){this.timeline.info({action:"retry",delay:e}),e>0&&this.emit("connecting_in",Math.round(e/1e3)),this.retryTimer=new H(e||0,(()=>{this.disconnectInternally(),this.connect()}))}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new H(this.options.unavailableTimeout,(()=>{this.updateState("unavailable")}))}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new H(this.options.pongTimeout,(()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)}))}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new H(this.activityTimeout,(()=>{this.sendActivityCheck()})))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(e){return F({},e,{message:e=>{this.resetActivityCheck(),this.emit("message",e)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:e=>{this.emit("error",e)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(e){return F({},e,{connected:e=>{this.activityTimeout=Math.min(this.options.activityTimeout,e.activityTimeout,e.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(e.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let e=e=>t=>{t.error&&this.emit("error",{type:"WebSocketError",error:t.error}),e(t)};return{tls_only:e((()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)})),refused:e((()=>{this.disconnect()})),backoff:e((()=>{this.retryIn(1e3)})),retry:e((()=>{this.retryIn(0)}))}}setConnection(e){for(var t in this.connection=e,this.connectionCallbacks)this.connection.bind(t,this.connectionCallbacks[t]);this.resetActivityCheck()}abandonConnection(){if(this.connection){for(var e in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(e,this.connectionCallbacks[e]);var t=this.connection;return this.connection=null,t}}updateState(e,t){var n=this.state;if(this.state=e,n!==e){var i=e;"connected"===i&&(i+=" with new socket ID "+t.socket_id),ce.debug("State changed",n+" -> "+i),this.timeline.info({state:e,params:t}),this.emit("state_change",{previous:n,current:e}),this.emit(e,t)}}shouldRetry(){return"connecting"===this.state||"connected"===this.state}}class it{constructor(){this.channels={}}add(e,t){return this.channels[e]||(this.channels[e]=st(e,t)),this.channels[e]}all(){return W(this.channels)}find(e){return this.channels[e]}remove(e){var t=this.channels[e];return delete this.channels[e],t}disconnect(){V(this.channels,(function(e){e.disconnect()}))}}function st(e,t){if(0===e.indexOf("private-encrypted-")){if(t.config.nacl)return ot.createEncryptedChannel(e,t,t.config.nacl);let n="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",i=p.buildLogSuffix("encryptedChannelSupport");throw new y(`${n}. ${i}`)}if(0===e.indexOf("private-"))return ot.createPrivateChannel(e,t);if(0===e.indexOf("presence-"))return ot.createPresenceChannel(e,t);if(0===e.indexOf("#"))throw new v('Cannot create a channel with name "'+e+'".');return ot.createChannel(e,t)}var rt={createChannels(){return new it},createConnectionManager(e,t){return new nt(e,t)},createChannel(e,t){return new We(e,t)},createPrivateChannel(e,t){return new Je(e,t)},createPresenceChannel(e,t){return new Ye(e,t)},createEncryptedChannel(e,t,n){return new tt(e,t,n)},createTimelineSender(e,t){return new Ge(e,t)},createHandshake(e,t){return new Ve(e,t)},createAssistantToTheTransportManager(e,t,n){return new Xe(e,t,n)}},ot=rt;class at{constructor(e){this.options=e||{},this.livesLeft=this.options.lives||1/0}getAssistant(e){return ot.createAssistantToTheTransportManager(this,e,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class ct{constructor(e,t){this.strategies=e,this.loop=Boolean(t.loop),this.failFast=Boolean(t.failFast),this.timeout=t.timeout,this.timeoutLimit=t.timeoutLimit}isSupported(){return te(this.strategies,X.method("isSupported"))}connect(e,t){var n=this.strategies,i=0,s=this.timeout,r=null,o=(a,c)=>{c?t(null,c):(i+=1,this.loop&&(i%=n.length),i<n.length?(s&&(s*=2,this.timeoutLimit&&(s=Math.min(s,this.timeoutLimit))),r=this.tryStrategy(n[i],e,{timeout:s,failFast:this.failFast},o)):t(!0))};return r=this.tryStrategy(n[i],e,{timeout:s,failFast:this.failFast},o),{abort:function(){r.abort()},forceMinPriority:function(t){e=t,r&&r.forceMinPriority(t)}}}tryStrategy(e,t,n,i){var s=null,r=null;return n.timeout>0&&(s=new H(n.timeout,(function(){r.abort(),i(!0)}))),r=e.connect(t,(function(e,t){e&&s&&s.isRunning()&&!n.failFast||(s&&s.ensureAborted(),i(e,t))})),{abort:function(){s&&s.ensureAborted(),r.abort()},forceMinPriority:function(e){r.forceMinPriority(e)}}}}class ut{constructor(e){this.strategies=e}isSupported(){return te(this.strategies,X.method("isSupported"))}connect(e,t){return ht(this.strategies,e,(function(e,n){return function(i,s){n[e].error=i,i?lt(n)&&t(!0):(J(n,(function(e){e.forceMinPriority(s.transport.priority)})),t(null,s))}}))}}function ht(e,t,n){var i=Q(e,(function(e,i,s,r){return e.connect(t,n(i,r))}));return{abort:function(){J(i,dt)},forceMinPriority:function(e){J(i,(function(t){t.forceMinPriority(e)}))}}}function lt(e){return ne(e,(function(e){return Boolean(e.error)}))}function dt(e){e.error||e.aborted||(e.abort(),e.aborted=!0)}class pt{constructor(e,t,n){this.strategy=e,this.transports=t,this.ttl=n.ttl||18e5,this.usingTLS=n.useTLS,this.timeline=n.timeline}isSupported(){return this.strategy.isSupported()}connect(e,t){var n=this.usingTLS,i=vt(n),s=i&&i.cacheSkipCount?i.cacheSkipCount:0,r=[this.strategy];if(i&&i.timestamp+this.ttl>=X.now()){var o=this.transports[i.transport];o&&(["ws","wss"].includes(i.transport)||s>3?(this.timeline.info({cached:!0,transport:i.transport,latency:i.latency}),r.push(new ct([o],{timeout:2*i.latency+1e3,failFast:!0}))):s++)}var a=X.now(),c=r.pop().connect(e,(function i(o,u){o?(mt(n),r.length>0?(a=X.now(),c=r.pop().connect(e,i)):t(o)):(gt(n,u.transport.name,X.now()-a,s),t(null,u))}));return{abort:function(){c.abort()},forceMinPriority:function(t){e=t,c&&c.forceMinPriority(t)}}}}function ft(e){return"pusherTransport"+(e?"TLS":"NonTLS")}function vt(e){var t=Kt.getLocalStorage();if(t)try{var n=t[ft(e)];if(n)return JSON.parse(n)}catch(i){mt(e)}return null}function gt(e,t,n,i){var s=Kt.getLocalStorage();if(s)try{s[ft(e)]=oe({timestamp:X.now(),transport:t,latency:n,cacheSkipCount:i})}catch(r){}}function mt(e){var t=Kt.getLocalStorage();if(t)try{delete t[ft(e)]}catch(n){}}class bt{constructor(e,{delay:t}){this.strategy=e,this.options={delay:t}}isSupported(){return this.strategy.isSupported()}connect(e,t){var n,i=this.strategy,s=new H(this.options.delay,(function(){n=i.connect(e,t)}));return{abort:function(){s.ensureAborted(),n&&n.abort()},forceMinPriority:function(t){e=t,n&&n.forceMinPriority(t)}}}}class yt{constructor(e,t,n){this.test=e,this.trueBranch=t,this.falseBranch=n}isSupported(){var e=this.test()?this.trueBranch:this.falseBranch;return e.isSupported()}connect(e,t){var n=this.test()?this.trueBranch:this.falseBranch;return n.connect(e,t)}}class kt{constructor(e){this.strategy=e}isSupported(){return this.strategy.isSupported()}connect(e,t){var n=this.strategy.connect(e,(function(e,i){i&&n.abort(),t(e,i)}));return n}}function wt(e){return function(){return e.isSupported()}}var St=function(e,t,n){var i={};function s(t,s,r,o,a){var c=n(e,t,s,r,o,a);return i[t]=c,c}var r,o=Object.assign({},t,{hostNonTLS:e.wsHost+":"+e.wsPort,hostTLS:e.wsHost+":"+e.wssPort,httpPath:e.wsPath}),a=Object.assign({},o,{useTLS:!0}),c=Object.assign({},t,{hostNonTLS:e.httpHost+":"+e.httpPort,hostTLS:e.httpHost+":"+e.httpsPort,httpPath:e.httpPath}),u={loop:!0,timeout:15e3,timeoutLimit:6e4},h=new at({minPingDelay:1e4,maxPingDelay:e.activityTimeout}),l=new at({lives:2,minPingDelay:1e4,maxPingDelay:e.activityTimeout}),d=s("ws","ws",3,o,h),p=s("wss","ws",3,a,h),f=s("sockjs","sockjs",1,c),v=s("xhr_streaming","xhr_streaming",1,c,l),g=s("xdr_streaming","xdr_streaming",1,c,l),m=s("xhr_polling","xhr_polling",1,c),b=s("xdr_polling","xdr_polling",1,c),y=new ct([d],u),k=new ct([p],u),w=new ct([f],u),S=new ct([new yt(wt(v),v,g)],u),_=new ct([new yt(wt(m),m,b)],u),C=new ct([new yt(wt(S),new ut([S,new bt(_,{delay:4e3})]),_)],u),T=new yt(wt(C),C,w);return r=t.useTLS?new ut([y,new bt(T,{delay:2e3})]):new ut([y,new bt(k,{delay:2e3}),new bt(T,{delay:5e3})]),new pt(new kt(new yt(wt(d),r,T)),i,{ttl:18e5,timeline:t.timeline,useTLS:t.useTLS})},_t=St,Ct=function(){var e=this;e.timeline.info(e.buildTimelineMessage({transport:e.name+(e.options.useTLS?"s":"")})),e.hooks.isInitialized()?e.changeState("initialized"):e.hooks.file?(e.changeState("initializing"),u.load(e.hooks.file,{useTLS:e.options.useTLS},(function(t,n){e.hooks.isInitialized()?(e.changeState("initialized"),n(!0)):(t&&e.onError(t),e.onClose(),n(!1))}))):e.onClose()},Tt={getRequest:function(e){var t=new window.XDomainRequest;return t.ontimeout=function(){e.emit("error",new g),e.close()},t.onerror=function(t){e.emit("error",t),e.close()},t.onprogress=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText)},t.onload=function(){t.responseText&&t.responseText.length>0&&e.onChunk(200,t.responseText),e.emit("finished",200),e.close()},t},abortRequest:function(e){e.ontimeout=e.onerror=e.onprogress=e.onload=null,e.abort()}},Et=Tt;const Ot=262144;class Pt extends _e{constructor(e,t,n){super(),this.hooks=e,this.method=t,this.url=n}start(e){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},Kt.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(e)}close(){this.unloader&&(Kt.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(e,t){while(1){var n=this.advanceBuffer(t);if(!n)break;this.emit("chunk",{status:e,data:n})}this.isBufferTooLong(t)&&this.emit("buffer_too_long")}advanceBuffer(e){var t=e.slice(this.position),n=t.indexOf("\n");return-1!==n?(this.position+=n+1,t.slice(0,n)):null}isBufferTooLong(e){return this.position===e.length&&e.length>Ot}}var Lt;(function(e){e[e["CONNECTING"]=0]="CONNECTING",e[e["OPEN"]=1]="OPEN",e[e["CLOSED"]=3]="CLOSED"})(Lt||(Lt={}));var xt=Lt,Rt=1;class It{constructor(e,t){this.hooks=e,this.session=Mt(1e3)+"/"+Ut(8),this.location=At(t),this.readyState=xt.CONNECTING,this.openStream()}send(e){return this.sendRaw(JSON.stringify([e]))}ping(){this.hooks.sendHeartbeat(this)}close(e,t){this.onClose(e,t,!0)}sendRaw(e){if(this.readyState!==xt.OPEN)return!1;try{return Kt.createSocketRequest("POST",jt(Nt(this.location,this.session))).start(e),!0}catch(t){return!1}}reconnect(){this.closeStream(),this.openStream()}onClose(e,t,n){this.closeStream(),this.readyState=xt.CLOSED,this.onclose&&this.onclose({code:e,reason:t,wasClean:n})}onChunk(e){if(200===e.status){var t;this.readyState===xt.OPEN&&this.onActivity();var n=e.data.slice(0,1);switch(n){case"o":t=JSON.parse(e.data.slice(1)||"{}"),this.onOpen(t);break;case"a":t=JSON.parse(e.data.slice(1)||"[]");for(var i=0;i<t.length;i++)this.onEvent(t[i]);break;case"m":t=JSON.parse(e.data.slice(1)||"null"),this.onEvent(t);break;case"h":this.hooks.onHeartbeat(this);break;case"c":t=JSON.parse(e.data.slice(1)||"[]"),this.onClose(t[0],t[1],!0);break}}}onOpen(e){this.readyState===xt.CONNECTING?(e&&e.hostname&&(this.location.base=Dt(this.location.base,e.hostname)),this.readyState=xt.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(e){this.readyState===xt.OPEN&&this.onmessage&&this.onmessage({data:e})}onActivity(){this.onactivity&&this.onactivity()}onError(e){this.onerror&&this.onerror(e)}openStream(){this.stream=Kt.createSocketRequest("POST",jt(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",(e=>{this.onChunk(e)})),this.stream.bind("finished",(e=>{this.hooks.onFinished(this,e)})),this.stream.bind("buffer_too_long",(()=>{this.reconnect()}));try{this.stream.start()}catch(e){X.defer((()=>{this.onError(e),this.onClose(1006,"Could not start streaming",!1)}))}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function At(e){var t=/([^\?]*)\/*(\??.*)/.exec(e);return{base:t[1],queryString:t[2]}}function Nt(e,t){return e.base+"/"+t+"/xhr_send"}function jt(e){var t=-1===e.indexOf("?")?"?":"&";return e+t+"t="+ +new Date+"&n="+Rt++}function Dt(e,t){var n=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(e);return n[1]+t+n[3]}function Mt(e){return Kt.randomInt(e)}function Ut(e){for(var t=[],n=0;n<e;n++)t.push(Mt(32).toString(32));return t.join("")}var Ht=It,qt={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr_streaming"+e.queryString},onHeartbeat:function(e){e.sendRaw("[]")},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){e.onClose(1006,"Connection interrupted ("+t+")",!1)}},zt=qt,Xt={getReceiveURL:function(e,t){return e.base+"/"+t+"/xhr"+e.queryString},onHeartbeat:function(){},sendHeartbeat:function(e){e.sendRaw("[]")},onFinished:function(e,t){200===t?e.reconnect():e.onClose(1006,"Connection interrupted ("+t+")",!1)}},Ft=Xt,Bt={getRequest:function(e){var t=Kt.getXHRAPI(),n=new t;return n.onreadystatechange=n.onprogress=function(){switch(n.readyState){case 3:n.responseText&&n.responseText.length>0&&e.onChunk(n.status,n.responseText);break;case 4:n.responseText&&n.responseText.length>0&&e.onChunk(n.status,n.responseText),e.emit("finished",n.status),e.close();break}},n},abortRequest:function(e){e.onreadystatechange=null,e.abort()}},$t=Bt,Vt={createStreamingSocket(e){return this.createSocket(zt,e)},createPollingSocket(e){return this.createSocket(Ft,e)},createSocket(e,t){return new Ht(e,t)},createXHR(e,t){return this.createRequest($t,e,t)},createRequest(e,t,n){return new Pt(e,t,n)}},Gt=Vt;Gt.createXDR=function(e,t){return this.createRequest(Et,e,t)};var Wt,Jt=Gt,Qt={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:s,DependenciesReceivers:c,getDefaultStrategy:_t,Transports:He,transportConnectionInitializer:Ct,HTTPFactory:Jt,TimelineTransport:ve,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(e){window.Pusher=e;var t=()=>{this.onDocumentBody(e.ready)};window.JSON?t():u.load("json2",{},t)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:C,jsonp:he}},onDocumentBody(e){document.body?e():setTimeout((()=>{this.onDocumentBody(e)}),0)},createJSONPRequest(e,t){return new de(e,t)},createScriptRequest(e){return new le(e)},getLocalStorage(){try{return window.localStorage}catch(e){return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var e=this.getXHRAPI();return new e},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return ze},createWebSocket(e){var t=this.getWebSocketAPI();return new t(e)},createSocketRequest(e,t){if(this.isXHRSupported())return this.HTTPFactory.createXHR(e,t);if(this.isXDRSupported(0===t.indexOf("https:")))return this.HTTPFactory.createXDR(e,t);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var e=this.getXHRAPI();return Boolean(e)&&void 0!==(new e).withCredentials},isXDRSupported(e){var t=e?"https:":"http:",n=this.getProtocol();return Boolean(window["XDomainRequest"])&&n===t},addUnloadListener(e){void 0!==window.addEventListener?window.addEventListener("unload",e,!1):void 0!==window.attachEvent&&window.attachEvent("onunload",e)},removeUnloadListener(e){void 0!==window.addEventListener?window.removeEventListener("unload",e,!1):void 0!==window.detachEvent&&window.detachEvent("onunload",e)},randomInt(e){const t=function(){const e=window.crypto||window["msCrypto"],t=e.getRandomValues(new Uint32Array(1))[0];return t/Math.pow(2,32)};return Math.floor(t()*e)}},Kt=Qt;(function(e){e[e["ERROR"]=3]="ERROR",e[e["INFO"]=6]="INFO",e[e["DEBUG"]=7]="DEBUG"})(Wt||(Wt={}));var Yt=Wt;class Zt{constructor(e,t,n){this.key=e,this.session=t,this.events=[],this.options=n||{},this.sent=0,this.uniqueID=0}log(e,t){e<=this.options.level&&(this.events.push(F({},t,{timestamp:X.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(e){this.log(Yt.ERROR,e)}info(e){this.log(Yt.INFO,e)}debug(e){this.log(Yt.DEBUG,e)}isEmpty(){return 0===this.events.length}send(e,t){var n=F({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],e(n,((e,n)=>{e||this.sent++,t&&t(e,n)})),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class en{constructor(e,t,n,i){this.name=e,this.priority=t,this.transport=n,this.options=i||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(e,t){if(!this.isSupported())return tn(new w,t);if(this.priority<e)return tn(new m,t);var n=!1,i=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),s=null,r=function(){i.unbind("initialized",r),i.connect()},o=function(){s=ot.createHandshake(i,(function(e){n=!0,u(),t(null,e)}))},a=function(e){u(),t(e)},c=function(){var e;u(),e=oe(i),t(new b(e))},u=function(){i.unbind("initialized",r),i.unbind("open",o),i.unbind("error",a),i.unbind("closed",c)};return i.bind("initialized",r),i.bind("open",o),i.bind("error",a),i.bind("closed",c),i.initialize(),{abort:()=>{n||(u(),s?s.close():i.close())},forceMinPriority:e=>{n||this.priority<e&&(s?s.close():i.close())}}}}function tn(e,t){return X.defer((function(){t(e)})),{abort:function(){},forceMinPriority:function(){}}}const{Transports:nn}=Kt;var sn=function(e,t,n,i,s,r){var o=nn[n];if(!o)throw new k(n);var a,c=(!e.enabledTransports||-1!==$(e.enabledTransports,t))&&(!e.disabledTransports||-1===$(e.disabledTransports,t));return c?(s=Object.assign({ignoreNullOrigin:e.ignoreNullOrigin},s),a=new en(t,i,r?r.getAssistant(o):o,s)):a=rn,a},rn={isSupported:function(){return!1},connect:function(e,t){var n=X.defer((function(){t(new w)}));return{abort:function(){n.ensureAborted()},forceMinPriority:function(){}}}};function on(e){if(null==e)throw"You must pass an options object";if(null==e.cluster)throw"Options object must provide a cluster";"disableStats"in e&&ce.warn("The disableStats option is deprecated in favor of enableStats")}const an=(e,t)=>{var n="socket_id="+encodeURIComponent(e.socketId);for(var i in t.params)n+="&"+encodeURIComponent(i)+"="+encodeURIComponent(t.params[i]);if(null!=t.paramsProvider){let e=t.paramsProvider();for(var i in e)n+="&"+encodeURIComponent(i)+"="+encodeURIComponent(e[i])}return n},cn=e=>{if("undefined"===typeof Kt.getAuthorizers()[e.transport])throw`'${e.transport}' is not a recognized auth transport`;return(t,n)=>{const i=an(t,e);Kt.getAuthorizers()[e.transport](Kt,i,e,d.UserAuthentication,n)}};var un=cn;const hn=(e,t)=>{var n="socket_id="+encodeURIComponent(e.socketId);for(var i in n+="&channel_name="+encodeURIComponent(e.channelName),t.params)n+="&"+encodeURIComponent(i)+"="+encodeURIComponent(t.params[i]);if(null!=t.paramsProvider){let e=t.paramsProvider();for(var i in e)n+="&"+encodeURIComponent(i)+"="+encodeURIComponent(e[i])}return n},ln=e=>{if("undefined"===typeof Kt.getAuthorizers()[e.transport])throw`'${e.transport}' is not a recognized auth transport`;return(t,n)=>{const i=hn(t,e);Kt.getAuthorizers()[e.transport](Kt,i,e,d.ChannelAuthorization,n)}};var dn=ln;const pn=(e,t,n)=>{const i={authTransport:t.transport,authEndpoint:t.endpoint,auth:{params:t.params,headers:t.headers}};return(t,s)=>{const r=e.channel(t.channelName),o=n(r,i);o.authorize(t.socketId,s)}};function fn(e,t){let n={activityTimeout:e.activityTimeout||o.activityTimeout,cluster:e.cluster,httpPath:e.httpPath||o.httpPath,httpPort:e.httpPort||o.httpPort,httpsPort:e.httpsPort||o.httpsPort,pongTimeout:e.pongTimeout||o.pongTimeout,statsHost:e.statsHost||o.stats_host,unavailableTimeout:e.unavailableTimeout||o.unavailableTimeout,wsPath:e.wsPath||o.wsPath,wsPort:e.wsPort||o.wsPort,wssPort:e.wssPort||o.wssPort,enableStats:yn(e),httpHost:vn(e),useTLS:bn(e),wsHost:gn(e),userAuthenticator:wn(e),channelAuthorizer:_n(e,t)};return"disabledTransports"in e&&(n.disabledTransports=e.disabledTransports),"enabledTransports"in e&&(n.enabledTransports=e.enabledTransports),"ignoreNullOrigin"in e&&(n.ignoreNullOrigin=e.ignoreNullOrigin),"timelineParams"in e&&(n.timelineParams=e.timelineParams),"nacl"in e&&(n.nacl=e.nacl),n}function vn(e){return e.httpHost?e.httpHost:e.cluster?`sockjs-${e.cluster}.pusher.com`:o.httpHost}function gn(e){return e.wsHost?e.wsHost:mn(e.cluster)}function mn(e){return`ws-${e}.pusher.com`}function bn(e){return"https:"===Kt.getProtocol()||!1!==e.forceTLS}function yn(e){return"enableStats"in e?e.enableStats:"disableStats"in e&&!e.disableStats}const kn=e=>"customHandler"in e&&null!=e["customHandler"];function wn(e){const t=Object.assign(Object.assign({},o.userAuthentication),e.userAuthentication);return kn(t)?t["customHandler"]:un(t)}function Sn(e,t){let n;if("channelAuthorization"in e)n=Object.assign(Object.assign({},o.channelAuthorization),e.channelAuthorization);else if(n={transport:e.authTransport||o.authTransport,endpoint:e.authEndpoint||o.authEndpoint},"auth"in e&&("params"in e.auth&&(n.params=e.auth.params),"headers"in e.auth&&(n.headers=e.auth.headers)),"authorizer"in e)return{customHandler:pn(t,n,e.authorizer)};return n}function _n(e,t){const n=Sn(e,t);return kn(n)?n["customHandler"]:dn(n)}class Cn extends _e{constructor(e){super((function(e,t){ce.debug(`No callbacks on watchlist events for ${e}`)})),this.pusher=e,this.bindWatchlistInternalEvent()}handleEvent(e){e.data.events.forEach((e=>{this.emit(e.name,e)}))}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",(e=>{var t=e.event;"pusher_internal:watchlist_events"===t&&this.handleEvent(e)}))}}function Tn(){let e,t;const n=new Promise(((n,i)=>{e=n,t=i}));return{promise:n,resolve:e,reject:t}}var En=Tn;class On extends _e{constructor(e){super((function(e,t){ce.debug("No callbacks on user for "+e)})),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(e,t)=>{if(e)return ce.warn(`Error during signin: ${e}`),void this._cleanup();this.pusher.send_event("pusher:signin",{auth:t.auth,user_data:t.user_data})},this.pusher=e,this.pusher.connection.bind("state_change",(({previous:e,current:t})=>{"connected"!==e&&"connected"===t&&this._signin(),"connected"===e&&"connected"!==t&&(this._cleanup(),this._newSigninPromiseIfNeeded())})),this.watchlist=new Cn(e),this.pusher.connection.bind("message",(e=>{var t=e.event;"pusher:signin_success"===t&&this._onSigninSuccess(e.data),this.serverToUserChannel&&this.serverToUserChannel.name===e.channel&&this.serverToUserChannel.handleEvent(e)}))}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),"connected"===this.pusher.connection.state&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(e){try{this.user_data=JSON.parse(e.user_data)}catch(t){return ce.error(`Failed parsing user data after signin: ${e.user_data}`),void this._cleanup()}if("string"!==typeof this.user_data.id||""===this.user_data.id)return ce.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),void this._cleanup();this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const e=e=>{e.subscriptionPending&&e.subscriptionCancelled?e.reinstateSubscription():e.subscriptionPending||"connected"!==this.pusher.connection.state||e.subscribe()};this.serverToUserChannel=new We(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global(((e,t)=>{0!==e.indexOf("pusher_internal:")&&0!==e.indexOf("pusher:")&&this.emit(e,t)})),e(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested)return;if(this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:e,resolve:t,reject:n}=En();e.done=!1;const i=()=>{e.done=!0};e.then(i).catch(i),this.signinDonePromise=e,this._signinDoneResolve=t}}class Pn{static ready(){Pn.isReady=!0;for(var e=0,t=Pn.instances.length;e<t;e++)Pn.instances[e].connect()}static getClientFeatures(){return G(Z({ws:Kt.Transports.ws},(function(e){return e.isSupported({})})))}constructor(e,t){xn(e),on(t),this.key=e,this.options=t,this.config=fn(this.options,this),this.channels=ot.createChannels(),this.global_emitter=new _e,this.sessionID=Kt.randomInt(1e9),this.timeline=new Zt(this.key,this.sessionID,{cluster:this.config.cluster,features:Pn.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:Yt.INFO,version:o.VERSION}),this.config.enableStats&&(this.timelineSender=ot.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+Kt.TimelineTransport.name}));var n=e=>Kt.getDefaultStrategy(this.config,e,sn);this.connection=ot.createConnectionManager(this.key,{getStrategy:n,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:Boolean(this.config.useTLS)}),this.connection.bind("connected",(()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())})),this.connection.bind("message",(e=>{var t=e.event,n=0===t.indexOf("pusher_internal:");if(e.channel){var i=this.channel(e.channel);i&&i.handleEvent(e)}n||this.global_emitter.emit(e.event,e.data)})),this.connection.bind("connecting",(()=>{this.channels.disconnect()})),this.connection.bind("disconnected",(()=>{this.channels.disconnect()})),this.connection.bind("error",(e=>{ce.warn(e)})),Pn.instances.push(this),this.timeline.info({instances:Pn.instances.length}),this.user=new On(this),Pn.isReady&&this.connect()}switchCluster(e){const{appKey:t,cluster:n}=e;this.key=t,this.options=Object.assign(Object.assign({},this.options),{cluster:n}),this.config=fn(this.options,this),this.connection.switchCluster(this.key)}channel(e){return this.channels.find(e)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var e=this.connection.isUsingTLS(),t=this.timelineSender;this.timelineSenderTimer=new q(6e4,(function(){t.send(e)}))}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(e,t,n){return this.global_emitter.bind(e,t,n),this}unbind(e,t,n){return this.global_emitter.unbind(e,t,n),this}bind_global(e){return this.global_emitter.bind_global(e),this}unbind_global(e){return this.global_emitter.unbind_global(e),this}unbind_all(e){return this.global_emitter.unbind_all(),this}subscribeAll(){var e;for(e in this.channels.channels)this.channels.channels.hasOwnProperty(e)&&this.subscribe(e)}subscribe(e){var t=this.channels.add(e,this);return t.subscriptionPending&&t.subscriptionCancelled?t.reinstateSubscription():t.subscriptionPending||"connected"!==this.connection.state||t.subscribe(),t}unsubscribe(e){var t=this.channels.find(e);t&&t.subscriptionPending?t.cancelSubscription():(t=this.channels.remove(e),t&&t.subscribed&&t.unsubscribe())}send_event(e,t,n){return this.connection.send_event(e,t,n)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}Pn.instances=[],Pn.isReady=!1,Pn.logToConsole=!1,Pn.Runtime=Kt,Pn.ScriptReceivers=Kt.ScriptReceivers,Pn.DependenciesReceivers=Kt.DependenciesReceivers,Pn.auth_callbacks=Kt.auth_callbacks;var Ln=t["default"]=Pn;function xn(e){if(null===e||void 0===e)throw"You must pass your app key when you instantiate Pusher."}Kt.setup(Pn)}])}))},2159:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ct}});var i=n(6768),s=n(144),r=n(4232),o=n(5130),a=n(4300),c=n(7190),u=n(782);n(4114);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f.apply(this,arguments)}function v(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function b(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function w(e){var t=b();return function(){var n,i=g(e);if(t){var s=g(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return k(this,n)}}var S=function(){function e(){l(this,e)}return p(e,[{key:"listenForWhisper",value:function(e,t){return this.listen(".client-"+e,t)}},{key:"notification",value:function(e){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",e)}},{key:"stopListeningForWhisper",value:function(e,t){return this.stopListening(".client-"+e,t)}}]),e}(),_=function(){function e(t){l(this,e),this.namespace=t}return p(e,[{key:"format",value:function(e){return[".","\\"].includes(e.charAt(0))?e.substring(1):(this.namespace&&(e=this.namespace+"."+e),e.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(e){this.namespace=e}}]),e}(),C=function(e){v(n,e);var t=w(n);function n(e,i,s){var r;return l(this,n),r=t.call(this),r.name=i,r.pusher=e,r.options=s,r.eventFormatter=new _(r.options.namespace),r.subscribe(),r}return p(n,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(e,t){return this.on(this.eventFormatter.format(e),t),this}},{key:"listenToAll",value:function(e){var t=this;return this.subscription.bind_global((function(n,i){if(!n.startsWith("pusher:")){var s=t.options.namespace.replace(/\./g,"\\"),r=n.startsWith(s)?n.substring(s.length+1):"."+n;e(r,i)}})),this}},{key:"stopListening",value:function(e,t){return t?this.subscription.unbind(this.eventFormatter.format(e),t):this.subscription.unbind(this.eventFormatter.format(e)),this}},{key:"stopListeningToAll",value:function(e){return e?this.subscription.unbind_global(e):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(e){return this.on("pusher:subscription_succeeded",(function(){e()})),this}},{key:"error",value:function(e){return this.on("pusher:subscription_error",(function(t){e(t)})),this}},{key:"on",value:function(e,t){return this.subscription.bind(e,t),this}}]),n}(S),T=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,t){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),t),this}}]),n}(C),E=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,t){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),t),this}}]),n}(C),O=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"here",value:function(e){return this.on("pusher:subscription_succeeded",(function(t){e(Object.keys(t.members).map((function(e){return t.members[e]})))})),this}},{key:"joining",value:function(e){return this.on("pusher:member_added",(function(t){e(t.info)})),this}},{key:"whisper",value:function(e,t){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),t),this}},{key:"leaving",value:function(e){return this.on("pusher:member_removed",(function(t){e(t.info)})),this}}]),n}(C),P=function(e){v(n,e);var t=w(n);function n(e,i,s){var r;return l(this,n),r=t.call(this),r.events={},r.listeners={},r.name=i,r.socket=e,r.options=s,r.eventFormatter=new _(r.options.namespace),r.subscribe(),r}return p(n,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(e,t){return this.on(this.eventFormatter.format(e),t),this}},{key:"stopListening",value:function(e,t){return this.unbindEvent(this.eventFormatter.format(e),t),this}},{key:"subscribed",value:function(e){return this.on("connect",(function(t){e(t)})),this}},{key:"error",value:function(e){return this}},{key:"on",value:function(e,t){var n=this;return this.listeners[e]=this.listeners[e]||[],this.events[e]||(this.events[e]=function(t,i){n.name===t&&n.listeners[e]&&n.listeners[e].forEach((function(e){return e(i)}))},this.socket.on(e,this.events[e])),this.listeners[e].push(t),this}},{key:"unbind",value:function(){var e=this;Object.keys(this.events).forEach((function(t){e.unbindEvent(t)}))}},{key:"unbindEvent",value:function(e,t){this.listeners[e]=this.listeners[e]||[],t&&(this.listeners[e]=this.listeners[e].filter((function(e){return e!==t}))),t&&0!==this.listeners[e].length||(this.events[e]&&(this.socket.removeListener(e,this.events[e]),delete this.events[e]),delete this.listeners[e])}}]),n}(S),L=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,t){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(e),data:t}),this}}]),n}(P),x=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"here",value:function(e){return this.on("presence:subscribed",(function(t){e(t.map((function(e){return e.user_info})))})),this}},{key:"joining",value:function(e){return this.on("presence:joining",(function(t){return e(t.user_info)})),this}},{key:"whisper",value:function(e,t){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(e),data:t}),this}},{key:"leaving",value:function(e){return this.on("presence:leaving",(function(t){return e(t.user_info)})),this}}]),n}(L),R=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(e,t){return this}},{key:"listenToAll",value:function(e){return this}},{key:"stopListening",value:function(e,t){return this}},{key:"subscribed",value:function(e){return this}},{key:"error",value:function(e){return this}},{key:"on",value:function(e,t){return this}}]),n}(S),I=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,t){return this}}]),n}(R),A=function(e){v(n,e);var t=w(n);function n(){return l(this,n),t.apply(this,arguments)}return p(n,[{key:"here",value:function(e){return this}},{key:"joining",value:function(e){return this}},{key:"whisper",value:function(e,t){return this}},{key:"leaving",value:function(e){return this}}]),n}(R),N=function(){function e(t){l(this,e),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(t),this.connect()}return p(e,[{key:"setOptions",value:function(e){this.options=f(this._defaultOptions,e);var t=this.csrfToken();return t&&(this.options.auth.headers["X-CSRF-TOKEN"]=t,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=t),t=this.options.bearerToken,t&&(this.options.auth.headers["Authorization"]="Bearer "+t,this.options.userAuthentication.headers["Authorization"]="Bearer "+t),e}},{key:"csrfToken",value:function(){var e;return"undefined"!==typeof window&&window["Laravel"]&&window["Laravel"].csrfToken?window["Laravel"].csrfToken:this.options.csrfToken?this.options.csrfToken:"undefined"!==typeof document&&"function"===typeof document.querySelector&&(e=document.querySelector('meta[name="csrf-token"]'))?e.getAttribute("content"):null}}]),e}(),j=function(e){v(n,e);var t=w(n);function n(){var e;return l(this,n),e=t.apply(this,arguments),e.channels={},e}return p(n,[{key:"connect",value:function(){"undefined"!==typeof this.options.client?this.pusher=this.options.client:this.options.Pusher?this.pusher=new this.options.Pusher(this.options.key,this.options):this.pusher=new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(e,t,n){return this.channel(e).listen(t,n)}},{key:"channel",value:function(e){return this.channels[e]||(this.channels[e]=new C(this.pusher,e,this.options)),this.channels[e]}},{key:"privateChannel",value:function(e){return this.channels["private-"+e]||(this.channels["private-"+e]=new T(this.pusher,"private-"+e,this.options)),this.channels["private-"+e]}},{key:"encryptedPrivateChannel",value:function(e){return this.channels["private-encrypted-"+e]||(this.channels["private-encrypted-"+e]=new E(this.pusher,"private-encrypted-"+e,this.options)),this.channels["private-encrypted-"+e]}},{key:"presenceChannel",value:function(e){return this.channels["presence-"+e]||(this.channels["presence-"+e]=new O(this.pusher,"presence-"+e,this.options)),this.channels["presence-"+e]}},{key:"leave",value:function(e){var t=this,n=[e,"private-"+e,"private-encrypted-"+e,"presence-"+e];n.forEach((function(e,n){t.leaveChannel(e)}))}},{key:"leaveChannel",value:function(e){this.channels[e]&&(this.channels[e].unsubscribe(),delete this.channels[e])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),n}(N),D=function(e){v(n,e);var t=w(n);function n(){var e;return l(this,n),e=t.apply(this,arguments),e.channels={},e}return p(n,[{key:"connect",value:function(){var e=this,t=this.getSocketIO();return this.socket=t(this.options.host,this.options),this.socket.on("reconnect",(function(){Object.values(e.channels).forEach((function(e){e.subscribe()}))})),this.socket}},{key:"getSocketIO",value:function(){if("undefined"!==typeof this.options.client)return this.options.client;if("undefined"!==typeof io)return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(e,t,n){return this.channel(e).listen(t,n)}},{key:"channel",value:function(e){return this.channels[e]||(this.channels[e]=new P(this.socket,e,this.options)),this.channels[e]}},{key:"privateChannel",value:function(e){return this.channels["private-"+e]||(this.channels["private-"+e]=new L(this.socket,"private-"+e,this.options)),this.channels["private-"+e]}},{key:"presenceChannel",value:function(e){return this.channels["presence-"+e]||(this.channels["presence-"+e]=new x(this.socket,"presence-"+e,this.options)),this.channels["presence-"+e]}},{key:"leave",value:function(e){var t=this,n=[e,"private-"+e,"presence-"+e];n.forEach((function(e){t.leaveChannel(e)}))}},{key:"leaveChannel",value:function(e){this.channels[e]&&(this.channels[e].unsubscribe(),delete this.channels[e])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),n}(N),M=function(e){v(n,e);var t=w(n);function n(){var e;return l(this,n),e=t.apply(this,arguments),e.channels={},e}return p(n,[{key:"connect",value:function(){}},{key:"listen",value:function(e,t,n){return new R}},{key:"channel",value:function(e){return new R}},{key:"privateChannel",value:function(e){return new I}},{key:"encryptedPrivateChannel",value:function(e){return new I}},{key:"presenceChannel",value:function(e){return new A}},{key:"leave",value:function(e){}},{key:"leaveChannel",value:function(e){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),n}(N),U=function(){function e(t){l(this,e),this.options=t,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return p(e,[{key:"channel",value:function(e){return this.connector.channel(e)}},{key:"connect",value:function(){if("reverb"==this.options.broadcaster)this.connector=new j(f(f({},this.options),{cluster:""}));else if("pusher"==this.options.broadcaster)this.connector=new j(this.options);else if("socket.io"==this.options.broadcaster)this.connector=new D(this.options);else if("null"==this.options.broadcaster)this.connector=new M(this.options);else{if("function"!=typeof this.options.broadcaster)throw new Error("Broadcaster ".concat(h(this.options.broadcaster)," ").concat(this.options.broadcaster," is not supported."));this.connector=new this.options.broadcaster(this.options)}}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(e){return this.connector.presenceChannel(e)}},{key:"leave",value:function(e){this.connector.leave(e)}},{key:"leaveChannel",value:function(e){this.connector.leaveChannel(e)}},{key:"leaveAllChannels",value:function(){for(var e in this.connector.channels)this.leaveChannel(e)}},{key:"listen",value:function(e,t,n){return this.connector.listen(e,t,n)}},{key:"private",value:function(e){return this.connector.privateChannel(e)}},{key:"encryptedPrivate",value:function(e){return this.connector.encryptedPrivateChannel(e)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){"function"===typeof Vue&&Vue.http&&this.registerVueRequestInterceptor(),"function"===typeof axios&&this.registerAxiosRequestInterceptor(),"function"===typeof jQuery&&this.registerjQueryAjaxSetup(),"object"===("undefined"===typeof Turbo?"undefined":h(Turbo))&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var e=this;Vue.http.interceptors.push((function(t,n){e.socketId()&&t.headers.set("X-Socket-ID",e.socketId()),n()}))}},{key:"registerAxiosRequestInterceptor",value:function(){var e=this;axios.interceptors.request.use((function(t){return e.socketId()&&(t.headers["X-Socket-Id"]=e.socketId()),t}))}},{key:"registerjQueryAjaxSetup",value:function(){var e=this;"undefined"!=typeof jQuery.ajax&&jQuery.ajaxPrefilter((function(t,n,i){e.socketId()&&i.setRequestHeader("X-Socket-Id",e.socketId())}))}},{key:"registerTurboRequestInterceptor",value:function(){var e=this;document.addEventListener("turbo:before-fetch-request",(function(t){t.detail.fetchOptions.headers["X-Socket-Id"]=e.socketId()}))}}]),e}(),H=n(4594),q=n.n(H);const z="8e37520ff421ebdb4f93",X="ap2";window.Pusher=q();const F=new U({broadcaster:"pusher",key:z,cluster:X,encrypted:!0,forceTLS:!0});var B=F,V=n(1219),G=n(7021);const W=e=>((0,i.Qi)("data-v-26801d7c"),e=e(),(0,i.jt)(),e),J=W((()=>(0,i.Lk)("div",{class:"row"},[(0,i.Lk)("div",{class:"col-md-12 mb-4"},[(0,i.Lk)("h4",{class:"font-weight-bold"},"Customer Chats")])],-1))),Q={class:"row"},K={class:"col-md-3"},Y={class:"card p-4"},Z={key:0},ee=W((()=>(0,i.Lk)("div",{class:"d-flex flex-column justify-content-center align-items-center"},[(0,i.Lk)("div",{class:"spinner-border text-primary"}),(0,i.Lk)("p",{class:"mt-2"},"Loading conversations. Please wait...")],-1))),te=[ee],ne={key:1},ie={key:0},se=["onClick"],re={class:"me-3"},oe=["src","alt"],ae={class:"fw-bold text-dark mb-0"},ce={class:"mb-0 text-dark text-md mb-2"},ue={class:"text-muted"},he={key:1},le=W((()=>(0,i.Lk)("div",{class:"d-flex flex-col justify-content-center align-items-center py-4"},[(0,i.Lk)("p",{class:"fw-bold text-center mb-3 text-lg"},"No tickets opened."),(0,i.Lk)("img",{src:"/img/no_data.svg",alt:"Chat Illustration",class:"mb-4",width:"200px"}),(0,i.Lk)("p",{class:"fw-medium text-center"},"There are no chat conversations yet. No tickets opened yet.")],-1))),de=[le],pe={class:"col-md-9"},fe={key:0},ve=W((()=>(0,i.Lk)("div",{class:"d-flex flex-column justify-content-center align-items-center"},[(0,i.Lk)("div",{class:"spinner-border text-primary"}),(0,i.Lk)("p",{class:"mt-2"},"Loading messages. Please wait...")],-1))),ge=[ve],me={key:1},be={class:"card"},ye={key:0},ke={class:"d-flex p-4"},we={class:"me-3"},Se=["src","alt"],_e={class:"fw-bold text-dark mb-0"},Ce={class:"mb-0 text-dark"},Te=W((()=>(0,i.Lk)("hr",{class:"my-0"},null,-1))),Ee={class:"pt-4"},Oe={key:0},Pe={key:0,class:"d-flex justify-content-start mb-3"},Le={class:"message-container"},xe={key:0},Re=["src"],Ie={key:1},Ae={class:"message-time"},Ne={key:1,class:"d-flex justify-content-end mb-4"},je={class:"message-container-send"},De={key:0},Me=["src"],Ue={key:1},He={class:"message-time-send"},qe={key:1},ze={class:"d-flex flex-col justify-content-center align-items-center py-4"},Xe=W((()=>(0,i.Lk)("img",{src:"/img/no_data.svg",alt:"Chat Illustration",class:"mb-4",width:"250px"},null,-1))),Fe={class:"fw-medium"},Be=W((()=>(0,i.Lk)("hr",{class:"my-0"},null,-1))),$e={class:"p-3"},Ve={class:"input-group"},Ge={class:"input-group-text"},We=["disabled"],Je=["disabled"],Qe=W((()=>(0,i.Lk)("i",{class:"bi bi-send"},null,-1))),Ke=[Qe],Ye={key:0,class:"mt-2 d-flex align-items-center"},Ze=["src"],et=W((()=>(0,i.Lk)("i",{class:"bi bi-x"},null,-1))),tt=[et],nt={key:1},it=W((()=>(0,i.Lk)("div",{class:"d-flex flex-col justify-content-center align-items-center py-4"},[(0,i.Lk)("img",{src:"/img/chat_illustration.svg",alt:"Chat Illustration",class:"mb-4",width:"250px"}),(0,i.Lk)("p",{class:"fw-medium"},"Click on a conversation to check messages.")],-1))),st=[it];var rt={__name:"ChatWithCustomers",setup(e){const t=(0,u.Pj)(),n=(0,s.KR)({message:"",conversation_id:"",image:"",imagePreview:""}),h=(0,s.KR)(!1);let l=(0,i.EW)({get:()=>t.state.chat.conversations,set:e=>t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e)}),d=(0,i.EW)({get:()=>t.state.chat.isFetchingCustomerConversations,set:e=>t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",e)}),p=(0,i.EW)({get:()=>t.state.chat.isFetchingConversationMessages,set:e=>t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",e)}),f=(0,i.EW)({get:()=>t.state.chat.selectedConversation,set:e=>t.commit("chat/SET_SELECTED_CONVERSATION",e)}),v=(0,i.EW)({get:()=>t.state.chat.messages,set:e=>t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e)});(0,i.sV)((()=>{b(),B.private("chat").listen("MessageSent",(e=>{console.log(e),w(e.conversationId),b()}))}));const g=e=>{const t=e.target.files[0];if(!t)return void(n.value.image=null);if(t.size>2097152)return V.nk.error("Image file size exceeds 2MB limit. Please upload a smaller image."),void(e.target.value=null);const i=new FileReader;i.onload=e=>{n.value.imagePreview=e.target.result},i.readAsDataURL(t),n.value.image=t},m=()=>{n.value.image=null,n.value.imagePreview=null,document.getElementById("image-input").value=""},b=()=>{t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!0),a.A.get(c.pe.GET_CUSTOMER_CONVERSATIONS).then((e=>{t.commit("chat/STORE_CUSTOMER_CONVERSATIONS",e.data.data),t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!1)})).catch((e=>{t.commit("chat/SET_IS_FETCHING_CUSTOMER_CONVERSATIONS",!1)}))},y=e=>{t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!0),a.A.post(c.pe.GET_CONVERSATION_MESSAGES,{conversation_id:e.conversation_id}).then((n=>{t.commit("chat/SET_SELECTED_CONVERSATION",e),t.commit("chat/STORE_CONVERSATION_MESSAGES",n.data.data),t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!1)})).catch((e=>{t.commit("chat/SET_IS_FETCHING_CONVERSATION_MESSAGES",!1)}))},k=async()=>{try{h.value=!0;const e=t.state.chat.selectedConversation.conversation_id,i=new FormData;i.append("message",n.value.message),i.append("conversation_id",e),n.value.image&&i.append("image",n.value.image);const s=await a.A.post(c.pe.SEND_MESSAGE_TO_CUSTOMER,i);$.growl.notice({message:s.data}),n.value.message="",m(),await w(e)}catch(e){console.error("Error sending message:",e)}finally{h.value=!1}},w=async e=>{try{const n=await a.A.post(c.pe.GET_CONVERSATION_MESSAGES,{conversation_id:e});t.commit("chat/STORE_CONVERSATION_MESSAGES",n.data.data)}catch(n){console.error("Error fetching new messages:",n)}};return(e,t)=>((0,i.uX)(),(0,i.CE)("div",null,[J,(0,i.Lk)("div",Q,[(0,i.Lk)("div",K,[(0,i.Lk)("div",Y,[(0,s.R1)(d)?((0,i.uX)(),(0,i.CE)("div",Z,te)):((0,i.uX)(),(0,i.CE)("div",ne,[(0,s.R1)(l).length>0?((0,i.uX)(),(0,i.CE)("div",ie,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(l),((e,t)=>((0,i.uX)(),(0,i.CE)("a",{href:"#",onClick:t=>y(e),class:(0,r.C4)(["d-flex p-3 chat-box",{"border-bottom":(0,s.R1)(l).length>1}]),key:`conversation-${e.id}`},[(0,i.Lk)("div",re,[(0,i.Lk)("img",{src:e.conversation.data.customer_photo,class:"rounded-circle",style:{width:"60px"},alt:e.conversation.data.customer_name},null,8,oe)]),(0,i.Lk)("div",null,[(0,i.Lk)("p",ae,(0,r.v_)(e.conversation.data.customer_name)+" - "+(0,r.v_)(e.conversation.data.module),1),(0,i.Lk)("p",ce,(0,r.v_)(e.conversation.last_message?(0,s.R1)(G.f7)(e.conversation.last_message.body):"Start Message"),1),(0,i.Lk)("small",ue,(0,r.v_)(e.conversation.last_message?(0,s.R1)(G.kp)(e.conversation.last_message.updated_at):""),1)])],10,se)))),128))])):((0,i.uX)(),(0,i.CE)("div",he,de))]))])]),(0,i.Lk)("div",pe,[(0,s.R1)(p)?((0,i.uX)(),(0,i.CE)("div",fe,ge)):((0,i.uX)(),(0,i.CE)("div",me,[(0,i.Lk)("div",be,[(0,s.R1)(f)?((0,i.uX)(),(0,i.CE)("div",ye,[(0,i.Lk)("div",ke,[(0,i.Lk)("div",we,[(0,i.Lk)("img",{src:(0,s.R1)(f).conversation.data.customer_photo,class:"rounded-circle",style:{width:"60px"},alt:(0,s.R1)(f).conversation.data.customer_name},null,8,Se)]),(0,i.Lk)("div",null,[(0,i.Lk)("p",_e,(0,r.v_)((0,s.R1)(f).conversation.data.customer_name)+" - "+(0,r.v_)((0,s.R1)(f).conversation.data.module),1),(0,i.Lk)("p",Ce,(0,r.v_)((0,s.R1)(f).conversation.data.customer_email),1)])]),Te,(0,i.Lk)("div",Ee,[(0,s.R1)(v).length>0?((0,i.uX)(),(0,i.CE)("div",Oe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,s.R1)(v),(e=>((0,i.uX)(),(0,i.CE)("div",{class:"px-3",key:`chat-${(0,s.R1)(f).id}-message-${e.id}`},[e.is_sender?e.is_sender?((0,i.uX)(),(0,i.CE)("div",Ne,[(0,i.Lk)("div",je,["image"===e.type?((0,i.uX)(),(0,i.CE)("div",De,[(0,i.Lk)("img",{src:e.body,alt:"Image",class:"chat-image"},null,8,Me)])):((0,i.uX)(),(0,i.CE)("div",Ue,(0,r.v_)(e.body),1)),(0,i.Lk)("span",He,(0,r.v_)(e.sender.name||e.sender.formatted_name)+" - "+(0,r.v_)((0,s.R1)(G.kp)(e.created_at)),1)])])):(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",Pe,[(0,i.Lk)("div",Le,["image"===e.type?((0,i.uX)(),(0,i.CE)("div",xe,[(0,i.Lk)("img",{src:e.body,alt:"Image",class:"chat-image"},null,8,Re)])):((0,i.uX)(),(0,i.CE)("div",Ie,(0,r.v_)(e.body),1)),(0,i.Lk)("span",Ae,(0,r.v_)(e.sender.name||e.sender.formatted_name)+" - "+(0,r.v_)((0,s.R1)(G.kp)(e.created_at)),1)])]))])))),128))])):((0,i.uX)(),(0,i.CE)("div",qe,[(0,i.Lk)("div",ze,[Xe,(0,i.Lk)("p",Fe,[(0,i.eW)("No messages present between you and "),(0,i.Lk)("b",null,(0,r.v_)((0,s.R1)(f).conversation.data.customer_name),1),(0,i.eW)(".")])])]))]),Be,(0,i.Lk)("div",$e,[(0,i.Lk)("form",{onSubmit:(0,o.D$)(k,["prevent"])},[(0,i.Lk)("div",Ve,[(0,i.Lk)("input",{type:"file",id:"image-input",onChange:g,accept:".jpg,.jpeg,.png,.gif",class:"d-none",ref:"imageInput"},null,544),(0,i.Lk)("span",Ge,[(0,i.Lk)("i",{class:"bi bi-paperclip",onClick:t[0]||(t[0]=t=>e.$refs.imageInput.click())})]),(0,i.bo)((0,i.Lk)("input",{class:"form-control me-3 border-0 border-bottom send-text-input rounded-0","onUpdate:modelValue":t[1]||(t[1]=e=>n.value.message=e),placeholder:"Type a message",disabled:h.value},null,8,We),[[o.Jo,n.value.message]]),(0,i.Lk)("button",{class:"btn btn-primary",type:"submit",disabled:h.value},Ke,8,Je)]),n.value.imagePreview?((0,i.uX)(),(0,i.CE)("div",Ye,[(0,i.Lk)("img",{src:n.value.imagePreview,alt:"Image Preview",class:"img-preview"},null,8,Ze),(0,i.Lk)("button",{onClick:m,type:"button",class:"btn btn-sm btn-danger ms-2",style:{"border-radius":"50%"}},tt)])):(0,i.Q3)("",!0)],32)])])):((0,i.uX)(),(0,i.CE)("div",nt,st))])]))])])]))}},ot=n(1241);const at=(0,ot.A)(rt,[["__scopeId","data-v-26801d7c"]]);var ct=at}}]);
//# sourceMappingURL=159.js.map