{"version":3,"file":"js/663.js","mappings":"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","sources":["webpack://myzola-admin/./src/views/investment_hub/companies/listed/Add.vue","webpack://myzola-admin/./src/views/investment_hub/companies/listed/Add.vue?dd84"],"sourcesContent":["<script setup>\n\nimport {useRouter} from \"vue-router\";\nimport {onMounted, ref, computed} from \"vue\";\nimport api from \"@/services/api\";\nimport {apiRoutes} from \"@/services/apiRoutes\";\nimport {useStore} from \"vuex\";\nimport CloseButton from \"@/components/CloseButton.vue\";\nimport { VueTelInput } from 'vue-tel-input';\nimport 'vue-tel-input/vue-tel-input.css';\nimport {startCase} from \"lodash-es\";\nimport {isSmallScreen, socialPlatforms} from \"@/services/Helpers\";\nimport {validateSocialHandle} from \"@/services/SocialHandlesLinksValidator\";\nimport {ElMessage} from \"element-plus\";\nimport SocialHandle from \"@/components/SocialHandle.vue\";\n\n/* ------------------------------\n* Variables & Properties\n* ------------------------------\n* */\nconst router = useRouter();\nconst store = useStore();\n\nconst company = ref({\n    name:\"\",\n    description:\"\",\n    contact_name:\"\",\n    contact_phone:\"\",\n    email:\"\",\n    about:\"\",\n});\nconst addedSocials = ref([]);\nconst newSocialHandle = ref({platform:\"\", link:\"\"});\n\nlet logoUpload = ref(null);\nlet logoFile = ref(null);\nconst isLoading = ref(false);\nconst isAddingSocialHandles = ref(false);\nlet aboutQuillEditor = ref(null);\n\n\n/* ------------------------------\n* Computed Properties\n* ------------------------------\n* */\nconst availableSocials = computed(()=>{\n    //get socials already added to the company\n    let alreadyAddedSocials = addedSocials.value.map(entry => entry.platform);\n    return socialPlatforms.filter(entry => !alreadyAddedSocials.includes(entry));\n});\n\n\n\n/* ------------------------------\n* Lifecycle Hooks\n* ------------------------------\n* */\nonMounted(()=>{\n    aboutQuillEditor = new Quill('#addCompanyAboutEditor', {\n        theme: 'snow',\n        placeholder: 'Enter company about here'\n    });\n});\n\n/* ------------------------------\n* Methods & functions\n* ------------------------------\n* */\nfunction processUpload(event){\n    logoUpload.value = event.target.files[0];\n\n    const file = event.target.files[0];\n    const reader = new FileReader();\n\n    reader.onload = (e) => {\n        logoFile.value = e.target.result;\n    };\n    reader.readAsDataURL(file);\n}\nfunction removeUpload(){\n    logoUpload.value = null;\n    logoFile.value = null;\n    $(\"#companyLogo\").val(\"\");\n}\nfunction selectSocialPlatform(social){\n    newSocialHandle.value.platform = social;\n    //if social platform is whatsapp, prefill the link field with whatsapp api link\n    newSocialHandle.value.link = social == 'whatsapp' ? \"https://wa.me/\" : \"\";\n}\nfunction addSocial(){\n    if(newSocialHandle.value.platform != 'whatsapp')\n        newSocialHandle.value.link = newSocialHandle.value.link.replace(/\\/+$/, '');\n\n    //validate link entered\n    if(!validateSocialHandle(newSocialHandle.value))\n        return ElMessage.warning(`Please enter a valid ${startCase(newSocialHandle.value.platform)} url`);\n\n    //add new social to company list of socials\n    addedSocials.value.push({\n        platform: newSocialHandle.value.platform,\n        link: newSocialHandle.value.link\n    });\n    //reset new social handle details\n    newSocialHandle.value = {platform: \"\", link: \"\"};\n}\nfunction submit(){\n    //validate that logo has been uploaded\n    if(!logoUpload.value)\n        return ElMessage.warning(\"Please upload the company logo\");\n\n    //validate that company about is provided\n    let about = aboutQuillEditor.getSemanticHTML();\n    if(!about || !about.toString().length || about == \"<p></p>\") {\n        return ElMessage.warning(\"Please enter the company's bio\");\n    }\n    company.value['about'] = about;\n\n    //validate that phone number is entered\n    if(!company.value.contact_phone || !company.value.contact_phone.toString().length) {\n        return ElMessage.warning(\"Please enter contact phone\");\n    }\n\n    //prepare request payload\n    let payload = new FormData();\n    //add all company details to the form data\n    Object.keys(company.value)\n            .forEach(key => {\n                let value = company.value[key];\n                if(key == 'contact_phone') value = value.toString().replaceAll(\" \", \"\");\n                payload.append(key, value)\n            });\n\n    //add logo to payload\n    payload.append('company_logo', logoUpload.value);\n\n    //where company socials are specified, add them to form data\n    if(addedSocials.value.length){\n        addedSocials.value.forEach((social, index) => {\n            payload.append(`socials[${index}][platform]`, social.platform);\n            payload.append(`socials[${index}][link]`, social.link);\n        });\n    }\n\n    //SHOW LOADER\n    isLoading.value = true;\n\n    //make api call\n    api.post(apiRoutes.ADD_INVESTMENT_HUB_LISTED_COMPANY, payload)\n            .then(response => {\n                //show success response\n                $.growl.notice({message: response.data.message});\n\n                //get a copy of current companies list\n                let companies = JSON.parse(JSON.stringify(store.state.investmentHub.companies));\n                //add the new company to the copy\n                companies.unshift(response.data.data);\n                //overwrite the vuex companies list with the updated copy\n                store.commit('investmentHub/STORE_LISTED_COMPANIES', companies)\n\n                //DISMISS LOADER\n                isLoading.value = false;\n\n                //navigate back to companies list\n                router.back();\n            })\n            .catch(error => isLoading.value = false);\n}\n\n</script>\n\n<template>\n\n    <div class=\"col-sm-12 mb-3 d-inline-flex align-items-center justify-content-between\">\n        <h6 class=\"fw-bold mb-0\" style=\"margin-left: 20px;\">Add a new Company</h6>\n        <close-button></close-button>\n    </div>\n\n    <form @submit.prevent=\"submit\" v-loading=\"isLoading\">\n        <div class=\"row\">\n            <div class=\"col-md-6\">\n                <!-- Logo -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"text\" class=\"form-control\" id=\"companyName\"\n                               placeholder=\"Company Name\" v-model=\"company.name\" required>\n                        <label for=\"companyName\">Company Name</label>\n                    </div>\n                </div>\n\n                <!-- Tagline -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"text\" class=\"form-control\" id=\"companyTagline\"\n                               placeholder=\"Tagline\" v-model=\"company.description\" required>\n                        <label for=\"companyTagline\">Tagline</label>\n                    </div>\n                </div>\n\n                <!-- Contact Person -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"text\" class=\"form-control\" id=\"companyContactPerson\"\n                               placeholder=\"Company Person\" v-model=\"company.contact_name\" required>\n                        <label for=\"companyContactPerson\">Contact Person</label>\n                    </div>\n                </div>\n\n                <!-- Contact Phone -->\n                <div class=\"col-md-10 m-b-20\">\n                    <small class=\"text-muted\">Contact Phone</small>\n                    <vue-tel-input\n                            v-model=\"company.contact_phone\"\n                            mode=\"international\"></vue-tel-input>\n                </div>\n\n                <!-- Contact Email -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"email\" class=\"form-control\" id=\"companyContactEmail\"\n                               placeholder=\"Email\" v-model=\"company.email\" required>\n                        <label for=\"companyContactEmail\">Email</label>\n                    </div>\n                </div>\n\n                <!-- About -->\n                <div class=\"col-md-10 m-b-20\">\n                    <h6>Company's Bio (About)</h6>\n\n                    <!-- Quill Editor Default -->\n                    <div id=\"addCompanyAboutEditor\" class=\"quill-editor-default\">\n                    </div>\n                    <!-- End Quill Editor Default -->\n                </div>\n            </div>\n            <div class=\"col-md-6\">\n                <!-- Logo -->\n                <div class=\"col-md-10 m-b-20\">\n                    <div class=\"form-floating\">\n                        <input type=\"file\" class=\"form-control\" id=\"companyLogo\" @change=\"processUpload\" accept=\".png,.jpg,.jpeg,.gif\">\n                        <label for=\"companyLogo\">Company Logo</label>\n                    </div>\n\n                    <div class=\"d-flex flex-wrap m-t-10\" v-if=\"logoFile\">\n                        <div class=\"p-1 uploaded-image\">\n                            <img :src=\"logoFile\"  style=\"max-width:80px;max-height:60px;\">\n                            <div class=\"remover\" @click=\"removeUpload\">\n                                <i class=\"ri ri-close-line\"></i>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Socials -->\n                <div class=\"col-md-10 m-b-20\">\n                    <h6>Social Media Handles</h6>\n                    <div class=\"d-inline-flex align-items-center flex-wrap\">\n                        <div v-if=\"addedSocials.length\" class=\"d-inline-flex\">\n                            <social-handle v-for=\"(social, index) in addedSocials\"\n                                           :key=\"'form-current-socials-'+index\"\n                                           v-bind=\"social\"></social-handle>\n                        </div>\n                        <el-button @click=\"isAddingSocialHandles = !isAddingSocialHandles\" size=\"small\" round>\n                            <i class=\"ri ri-add-line\" v-if=\"!addedSocials.length\"></i>{{ addedSocials.length ? \"Click to edit\" : \"Click to add\" }}\n                        </el-button>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n\n        <hr>\n        <div class=\"modal-footer\">\n            <button class=\"btn btn-primary\" type=\"submit\">Add Company</button>\n            &nbsp;\n            <button @click=\"router.back()\" class=\"btn btn-secondary\" type=\"button\">Cancel</button>\n        </div>\n    </form>\n\n    <!-- Modal to add company socials -->\n    <el-dialog\n            :fullscreen=\"isSmallScreen\"\n            v-model=\"isAddingSocialHandles\">\n        <div class=\"row\" v-if=\"addedSocials.length\">\n            <h6 class=\"fw-bold\">\n                <small class=\"text-muted\">Currently added</small>\n            </h6>\n            <small class=\"text-muted text-italic\">Click to remove</small>\n            <div class=\"d-inline-flex\">\n                <div class=\"p-1\" @click=\"addedSocials.splice(index,1)\"\n                     v-for=\"(social, index) in addedSocials\" :key=\"'current-socials-'+index\">\n                    <social-handle :platform=\"social.platform\"></social-handle>\n                </div>\n            </div>\n        </div>\n        <br>\n        <div class=\"row\">\n            <h6 class=\"fw-bold\" v-if=\"addedSocials.length\">\n                <small class=\"text-muted\">Add more here</small>\n            </h6>\n            <div class=\"p-l-20\">\n                <form @submit.prevent=\"addSocial\">\n                    <p><small>Select Platform</small></p>\n                    <div class=\"d-inline-flex flex-wrap\">\n                        <template v-for=\"(social, index) in availableSocials\"\n                                  :key=\"'to-add-social'+index\">\n                            <div @click=\"selectSocialPlatform(social)\" v-if=\"social == newSocialHandle.platform\">\n                                <el-badge value=\"✓\" class=\"item\" type=\"primary\">\n                                    <social-handle :platform=\"social\"></social-handle>\n                                </el-badge>\n                            </div>\n                            <div @click=\"selectSocialPlatform(social)\" v-else>\n                                <social-handle :platform=\"social\"></social-handle>\n                            </div>\n                        </template>\n                    </div>\n                    <br><br>\n                    <div class=\"col-md-6\" v-if=\"newSocialHandle.platform.length\">\n                        <div class=\"input-group mb-3\">\n                            <div class=\"form-floating\">\n                                <input type=\"text\" class=\"form-control\" id=\"newSocialLink\"\n                                       placeholder=\"Tagline\" v-model=\"newSocialHandle.link\" required>\n                                <label for=\"newSocialLink\">\n                                    <template v-if=\"newSocialHandle.platform == 'whatsapp'\">\n                                        Enter Whatsapp number\n                                    </template>\n                                    <template v-else>\n                                        Enter {{ startCase(newSocialHandle.platform) }} Link here\n                                    </template>\n                                </label>\n                            </div>\n                            <span class=\"input-group-text\" id=\"basic-addon2\">\n                                <el-button native-type=\"submit\" link>Add</el-button>\n                            </span>\n                        </div>\n                        <small v-if=\"newSocialHandle.platform == 'whatsapp'\">Please enter the whatsapp number in international format (+254712345678)</small>\n                    </div>\n                </form>\n            </div>\n            <div class=\"col-sm-12 d-flex justify-content-end\">\n                <el-button type=\"primary\" @click=\"isAddingSocialHandles = !isAddingSocialHandles\">Close</el-button>\n            </div>\n        </div>\n    </el-dialog>\n\n</template>\n\n\n<style scoped>\n\n</style>","import script from \"./Add.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Add.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["router","useRouter","store","useStore","company","ref","name","description","contact_name","contact_phone","email","about","addedSocials","newSocialHandle","platform","link","logoUpload","logoFile","isLoading","isAddingSocialHandles","aboutQuillEditor","availableSocials","computed","alreadyAddedSocials","value","map","entry","socialPlatforms","filter","includes","processUpload","event","target","files","file","reader","FileReader","onload","e","result","readAsDataURL","removeUpload","$","val","selectSocialPlatform","social","addSocial","replace","validateSocialHandle","ElMessage","warning","startCase","push","submit","getSemanticHTML","toString","length","payload","FormData","Object","keys","forEach","key","replaceAll","append","index","api","post","apiRoutes","ADD_INVESTMENT_HUB_LISTED_COMPANY","then","response","growl","notice","message","data","companies","JSON","parse","stringify","state","investmentHub","unshift","commit","back","catch","error","onMounted","Quill","theme","placeholder","__exports__"],"sourceRoot":""}